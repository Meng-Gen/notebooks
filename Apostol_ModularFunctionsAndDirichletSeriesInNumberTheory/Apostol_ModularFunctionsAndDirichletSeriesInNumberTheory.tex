\documentclass{article}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{centernot}
\usepackage{hyperref}
\usepackage[none]{hyphenat}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{physics}
\usepackage{tikz-cd}
\parindent=0pt



\title{\textbf{Notes on the book: \\
\emph{Apostol, Modular Functions and Dirichlet Series in Number Theory, 2nd edition}}}
\author{Meng-Gen Tsai \\ plover@gmail.com}



\begin{document}
\maketitle
\tableofcontents



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



% Reference:
% http://pub.math.leidenuniv.nl/~luijkrmvan/elliptic/2011/ec.pdf
% http://archive.schools.cimpa.info/archivesecoles/20171023105958/cimpaEC.pdf
% https://rc476.user.srcf.net/furthercomplexmethods/ellfun.pdf
% https://warwick.ac.uk/fac/sci/maths/people/staff/david_loeffler/teaching/ma4h9/solutions2.pdf



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\newpage
\section*{Chapter 1: Elliptic functions \\}
\addcontentsline{toc}{section}{Chapter 1: Elliptic functions}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.1.}
\addcontentsline{toc}{subsubsection}{Exercise 1.1.}
\emph{Given two pairs of complex numbers $(\omega_1,\omega_2)$ and $(\omega'_1,\omega'_2)$
with nonreal ratios $\omega_1/\omega_2$ and $\omega'_1/\omega'_2$.
Prove that they generate the same set of periods if, and only if,
there is a $2 \times 2$ matrix
$\begin{pmatrix}
  a & b \\
  c & d
\end{pmatrix}$
with integer entries and determinant $\pm 1$ such that}
\[
  \begin{pmatrix}
    \omega'_2 \\
    \omega'_1
  \end{pmatrix}
  =
  \begin{pmatrix}
    a & b \\
    c & d
  \end{pmatrix}
  \begin{pmatrix}
    \omega_2 \\
    \omega_1
  \end{pmatrix}.
\] \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  ($\Longrightarrow$)
  Suppose $(\omega_1,\omega_2)$ and $(\omega'_1,\omega'_2)$
  generate the same set of periods.
  In particular,
  there is a $2 \times 2$ matrix
  $A := \begin{pmatrix}
    a & b \\
    c & d
  \end{pmatrix} \in \mathsf{M}_{2 \times 2}(\mathbb{Z})$
  (resp.
  $A' := \begin{pmatrix}
    a' & b' \\
    c' & d'
  \end{pmatrix} \in \mathsf{M}_{2 \times 2}(\mathbb{Z})$)
  such that
  \[
    \begin{pmatrix}
      \omega'_2 \\
      \omega'_1
    \end{pmatrix}
    =
    A
    \begin{pmatrix}
      \omega_2 \\
      \omega_1
    \end{pmatrix}, \qquad
    \begin{pmatrix}
      \omega_2 \\
      \omega_1
    \end{pmatrix}
    =
    A'
    \begin{pmatrix}
      \omega'_2 \\
      \omega'_1
    \end{pmatrix}.
  \]
  Hence it suffices to show $\det(A) = \pm 1$.

\item[(2)]
  Note that
  \[
    \begin{pmatrix}
      \omega'_2 \\
      \omega'_1
    \end{pmatrix}
    =
    A A'
    \begin{pmatrix}
      \omega'_2 \\
      \omega'_1
    \end{pmatrix}.
  \]
  Hence
  \[
    A A'
    =
    \begin{pmatrix}
      1 & 0 \\
      0 & 1
    \end{pmatrix}.
  \]
  Take the determinant on the both sides to get
  \[
    \det(A) \det(A') = 1.
  \]
  Since $\det(\mathsf{M}_{2 \times 2}(\mathbb{Z})) \subseteq \mathbb{Z}$,
  $\det(A) = \pm 1$.

\item[(3)]
  ($\Longleftarrow$)
  $\Omega(\omega'_1,\omega'_2) \subseteq \Omega(\omega_1,\omega_2)$ is obvious.
  Note that
  \[
    \begin{pmatrix}
      \omega_2 \\
      \omega_1
    \end{pmatrix}
    =
    \underbrace{\frac{1}{\det(A)}
    \begin{pmatrix}
      d & -b \\
      -c & a
    \end{pmatrix}}_{\in \mathsf{M}_{2 \times 2}(\mathbb{Z})}
    \begin{pmatrix}
      \omega'_2 \\
      \omega'_1
    \end{pmatrix}.
  \]
  Thus $\Omega(\omega_1,\omega_2) \subseteq \Omega(\omega'_1,\omega'_2)$.
  Therefore $\Omega(\omega_1,\omega_2) = \Omega(\omega'_1,\omega'_2)$.
\end{enumerate}
$\Box$ \\



\subsubsection*{Supplement 1.1.1.}
\addcontentsline{toc}{subsubsection}{Supplement 1.1.1.}
(Exercise I.1.1 in the textbook: \emph{J\"orgen Neukirch, Algebraic Number Theory}.)
\emph{$\alpha \in \mathbb{Z}[i]$ is a unit if and only if $N(\alpha) = 1$.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  \emph{$(\Longrightarrow)$}
  Since $\alpha$ is a unit, there is $\beta \in \mathbb{Z}[i]$ such that
  $\alpha \beta = 1$.
  So $N(\alpha \beta) = N(1)$, or $N(\alpha) N(\beta) = 1$.
  Since the image of $N$ is nonnegative integers, $N(\alpha) = 1$.

\item[(2)]
  \emph{$(\Longleftarrow)$}
  $N(\alpha) = \alpha \overline{\alpha}$,
  or $1 = \alpha \overline{\alpha}$ since $N(\alpha) = 1$.
  That is, $\overline{\alpha} \in \mathbb{Z}[i]$ is
  the inverse of $\alpha \in \mathbb{Z}[i]$.
  (Or we solve the equation $N(\alpha) = a^2 + b^2 = 1$,
  and show that all four solutions ($\pm 1$ and $\pm i$) are units.)

\item[(3)]
  Conclusion: a unit $\alpha = a+bi$ of $\mathbb{Z}[i]$
  is satisfying the equation $N(\alpha) = a^2 + b^2 = 1$ by (1)(2).
  That is, the only unit of $\mathbb{Z}[i]$ are $\pm 1$ and $\pm i$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.2.}
\addcontentsline{toc}{subsubsection}{Exercise 1.2.}
\emph{Let $S(0)$ denote the sum of the zeros of an elliptic function $f$
in a period parallelogram,
and let $S(\infty)$ denote the sum of the poles in the same parallelogram.
Prove that $S(0) - S(\infty)$ is a period of $f$.
(Hint: Integrate $z \frac{f'(z)}{f(z)}$.)} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Similar to Theorem 1.8,
  the integral
  \[
    \frac{1}{2\pi i} \int_{C} z \frac{f'(z)}{f(z)}
  \]
  taken around the boundary $C$ of a cell (no zeros or poles on its boundary)
  counts the difference between
  the sum of the zeros and the sum of the poles inside the cell, that is,
  \[
    S(0) - S(\infty) = \frac{1}{2\pi i} \int_{C} z \frac{f'(z)}{f(z)}.
  \]
  (The proof is similar to the proof of the argument principle.)

\item[(2)]
  Let $C_1$ be the path from $0$ to $\omega_1$,
  $C_2$ be the path from $\omega_1$ to $\omega_1 + \omega_2$,
  $C_3$ be the path from $\omega_1 + \omega_2$ to $\omega_2$,
  and $C_4$ be the path from $\omega_2$ to $0$.
  Hence
  \begin{align*}
    &\:
      \frac{1}{2\pi i} \int_{C_1} z \frac{f'(z)}{f(z)}
      + \frac{1}{2\pi i} \int_{C_3} z \frac{f'(z)}{f(z)} \\
    =&\:
      \frac{1}{2\pi i} \int_{C_1} z \frac{f'(z)}{f(z)}
      + \frac{1}{2\pi i} \int_{-C_1} (z+\omega_2) \frac{f'(z+\omega_2)}{f(z+\omega_2)} \\
    =&\:
      \frac{1}{2\pi i} \int_{C_1} z \frac{f'(z)}{f(z)}
      - \frac{1}{2\pi i} \int_{C_1} (z+\omega_2) \frac{f'(z)}{f(z)} \\
    =&\:
      - \omega_2 \frac{1}{2\pi i} \int_{C_1} \frac{f'(z)}{f(z)}
  \end{align*}
  and
  \begin{align*}
    &\:
      \frac{1}{2\pi i} \int_{C_2} z \frac{f'(z)}{f(z)}
      + \frac{1}{2\pi i} \int_{C_4} z \frac{f'(z)}{f(z)} \\
    =&\:
      \frac{1}{2\pi i} \int_{-C_4} (z+\omega_1) \frac{f'(z+\omega_1)}{f(z+\omega_1)}
      + \frac{1}{2\pi i} \int_{C_4} z \frac{f'(z)}{f(z)} \\
    =&\:
      - \frac{1}{2\pi i} \int_{C_4} (z+\omega_1) \frac{f'(z)}{f(z)}
      + \frac{1}{2\pi i} \int_{C_4} z \frac{f'(z)}{f(z)} \\
    =&\:
      - \omega_1 \frac{1}{2\pi i} \int_{C_4} \frac{f'(z)}{f(z)}
  \end{align*}
  Therefore
  \[
     S(0) - S(\infty)
     = - \omega_1 \frac{1}{2\pi i} \int_{C_4} \frac{f'(z)}{f(z)}
       - \omega_2 \frac{1}{2\pi i} \int_{C_1} \frac{f'(z)}{f(z)}.
  \]
  So it suffices to show that
  $\frac{1}{2\pi i} \int_{C_1} \frac{f'(z)}{f(z)} \in \mathbb{Z}$.
  (Other cases are similar.)

\item[(3)]
  By choosing one branch of $\log$, we have
  \begin{align*}
    \frac{1}{2\pi i} \int_{C_1} \frac{f'(z)}{f(z)}
    &= \frac{1}{2\pi i} \log \frac{f(\omega_1)}{f(0)} \\
    &= \frac{1}{2\pi i} \log (1)
      &(f(\omega_1) = f(0)) \\
    &= \frac{1}{2\pi i} (2\pi i m) \text{ for some $m \in \mathbb{Z}$} \\
    &= m \in \mathbb{Z}.
  \end{align*}
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.3.}
\addcontentsline{toc}{subsubsection}{Exercise 1.3.}
\begin{enumerate}
\item[(a)]
  \emph{Prove that $\wp(u) = \wp(v)$ if, and only if, $u-v$ or $u+v$ is a period of $\wp$.}

\item[(b)]
  \emph{Let $a_1, \ldots, a_n$ and $b_1, \ldots, b_m$ be complex numbers
  such that none of the numbers $\wp(a_i) - \wp(b_j)$ is zero.
  Let
  \[
    f(z) = \frac{\prod_{k=1}^{n}[\wp(z)-\wp(a_k)]}{\prod_{r=1}^{m}[\wp(z)-\wp(b_r)]}.
  \]
  Prove that $f$ is an even elliptic function with zeros at $a_1, \ldots, a_n$ and
  poles at $b_1, \ldots, b_m$.} \\
\end{enumerate}



\emph{Proof of (a).}
\begin{enumerate}
\item[(1)]
  Let $\Omega$ be the lattice generated by periods of $\wp$.

\item[(2)]
  ($\Longrightarrow$)
  It is equivalent to show that the equation $\wp(u) = \wp(v)$ in terms of $u$
  has exactly two roots in some period parallelogram.
  $u \equiv v \pmod{\Omega}$ is a root clearly and
  $u \equiv -v \pmod{\Omega}$ is also a root since $\wp$ is even.
  Since $\wp$ is an elliptic function of order $2$ (Theorem 1.8),
  $u \equiv \pm v \pmod{\Omega}$ is the only two roots of $\wp(u) = \wp(v)$.

\item[(3)]
  ($\Longleftarrow$)
  Obvious.
\end{enumerate}
$\Box$ \\



\emph{Proof of (b).}
\begin{enumerate}
\item[(1)]
  Since $\wp$ is an even elliptic function, $f$ is an even elliptic function too.

\item[(2)]
  $f$ has zeros at $a_1, \ldots, a_n$ and poles at $b_1, \ldots, b_m$
  (by construction and (a)).
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.4.}
\addcontentsline{toc}{subsubsection}{Exercise 1.4.}
\emph{Prove that every even elliptic function $f$ is a rational function of $\wp$,
where periods of $\wp$ are a subset of the periods of $f$.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Nothing to do if $f$ is constant.
  Let $C$ be one period parallelogram of $f$ and $\wp$.
  Let $\Omega(\omega_1,\omega_2)$ be the lattice generated by periods of $\wp$.
  Suppose $f$ has zeros at $a_1, \ldots, a_n$ and poles at $b_1, \ldots, b_m$.

\item[(2)]
  Might assume that
  $\wp(z) - \wp(a_k)$ (resp. $\wp(z) - \wp(b_r)$) has a simple zero in $a_k$ (resp. $b_r$)
  for all $k, r$.
  So the function
  \[
    g(z)
    :=
    f(z)
    \cdot
    \frac{\prod_{r=1}^{m}[\wp(z)-\wp(b_r)]^{\beta_r}}{\prod_{k=1}^{n}[\wp(z)-\wp(a_k)]^{\alpha_k}}
  \]
  is an elliptic function with no zeros or poles in $C$
  where $\alpha_k$ (resp. $\beta_r$) is the order of the zero $a_k$ (resp. the pole $b_r$).
  By Theorems 1.4 and 1.5, $g(z)$ is a constant.
  Hence
  \[
    f(z)
    =
    C \cdot
    \frac{\prod_{k=1}^{n}[\wp(z)-\wp(a_k)]^{\alpha_k}}{\prod_{r=1}^{m}[\wp(z)-\wp(b_r)]^{\beta_r}}
  \]
  for some constant $C \in \mathbb{C}$.

\item[(3)]
  Now we consider the case $a_k$ (resp. $b_r$) is a zero of $\wp'(z)$.
  Since $f$ is an even elliptic function, the order of $a_k$ (resp. $b_r$) of $f$ is even.
  Note that the order of $a_k$ (resp. $b_r$) of $\wp(z)-\wp(a_k)$ (resp. $\wp(z)-\wp(b_r)$) is $2$.
  Hence the function
  \[
    g(z)
    :=
    f(z)
    \cdot
    \frac{\prod_{\wp'(b_r) \neq 0}[\wp(z)-\wp(b_r)]^{\beta_r}}
      {\prod_{\wp'(a_k) \neq 0}[\wp(z)-\wp(a_k)]^{\alpha_k}}
    \cdot
    \frac{\prod_{\wp'(b_r) = 0}[\wp(z)-\wp(b_r)]^{\frac{\beta_r}{2}}}
      {\prod_{\wp'(a_k) = 0}[\wp(z)-\wp(a_k)]^{\frac{\alpha_k}{2}}}
  \]
  is a constant too.
\end{enumerate}
$\Box$ \\



\subsubsection*{Supplement 1.4.1. (Divisor class group)}
\addcontentsline{toc}{subsubsection}{Supplement 1.4.1. (Divisor class group)}
(Problem 8.6 in the textbook: \emph{William Fulton, Algebraic Curves}.)
\emph{Let $D(X)$ be the group of divisors on $X$,
$D_0(X)$ the subgroup consisting of divisors of degree zero,
and $P(X)$ the subgroup of $D_0(X)$ consisting of divisors of rational functions.
Let $C_0(X) = D_0(X)/P(X)$ be the quotient group.
It is the \textbf{divisor class group} on $X$.}
\begin{enumerate}
\item[(a)]
  \emph{If $X = \mathbf{P}^{1}$, then $C_0(X) = 0$.}

\item[(b)]
  \emph{Let $X = C$ be a nonsingular cubic.
  Pick $P_0 \in C$, defining $\oplus$ on $C$.
  Show that the map from $C$ to $C_0(X)$ that
  sends $P$ to the residue class of the divisor $P-P_0$
  is an isomorphism from $(C,\oplus)$ onto $C_0(X)$.} \\
\end{enumerate}



\emph{Proof of (a).}
\begin{enumerate}
\item[(1)]
  Given a divisor
  \[
    D = \sum_{P \in X} n_P P \in D_0(X)
  \]
  where $n_P \in \mathbb{Z}$ and $\sum_P n_P = 0$.

\item[(2)]
  Note that $\sum_P n_P = 0$.
  We can define a rational function $z \in k(X)$ by
  \[
    z
    = \prod_{P = [a_P:b_P] \in X} (b_P x - a_P y)^{n_P}.
  \]
  Hence $\mathrm{div}(z) = D \in P(X)$.
  Therefore $C_0(X) = D_0(X)/P(X) = 0$.
\end{enumerate}
$\Box$ \\



\emph{Proof of (b).}
\begin{enumerate}
\item[(1)]
  Define $\alpha: (C,\oplus) \to C_0(X)$ by $P \mapsto [P-P_0]$.

\item[(2)]
  \emph{Show that $\alpha$ is a group homomorphism.}
  If $P \oplus Q = R$, then
  \begin{align*}
    & \:
    P \oplus Q = R \\
    \Longleftrightarrow& \:
    [P + Q] = [R + P_0]
      &(\text{Problem 8.3(c)}) \\
    \Longleftrightarrow& \:
    [P - P_0] + [Q - P_0] = [R - P_0]
      &(\text{Proposition 2}) \\
    \Longleftrightarrow& \:
    \alpha(P) + \alpha(Q) = \alpha(R) = \alpha(P \oplus Q).
  \end{align*}

\item[(3)]
  \emph{Show that $\alpha$ is injective.}
  \begin{align*}
    \alpha(P) = 0
    \Longleftrightarrow& \:
    [P - P_0] = 0 \\
    \Longleftrightarrow& \:
    [P] = [P_0]
      &(\text{Proposition 2}) \\
    \Longleftrightarrow& \:
    P = P_0.
      &(\text{Problem 8.3(a)})
  \end{align*}

\item[(4)]
  \emph{Show that $\alpha$ is surjective.}
  Given $[D] \in C_0(X)$ and we want to find a point $P \in C$ such that $\alpha(P) = [D]$.
  Write
  \[
    D = (P_1 + \cdots + P_r) - (Q_1 + \cdots + Q_r)
  \]
  for some $P_i, Q_i \in C$.
  So
  \begin{align*}
    [D]
    &= [P_1 - P_0] + \cdots + [P_r - P_0] - [Q_1 - P_0] - \cdots - [Q_r - P_0] \\
    &= \alpha(P_1) + \cdots + \alpha(P_r) - \alpha(Q_1) - \cdots - \alpha(Q_r) \\
    &= \alpha(P_1) + \cdots + \alpha(P_r) + \alpha(Q_1') + \cdots + \alpha(Q_r') \\
    &= \alpha(P_1 \oplus \cdots \oplus P_r \oplus Q_1' \oplus \cdots \oplus Q_r').
  \end{align*}
  where $Q_i'$ is the inverse of $Q_i$ in $(C,\oplus)$.
  Hence there is a point $P := P_1 \oplus \cdots \oplus P_r \oplus Q_1' \oplus \cdots \oplus Q_r' \in C$
  such that $\alpha(P) = [D]$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.5.}
\addcontentsline{toc}{subsubsection}{Exercise 1.5.}
\emph{Prove that every elliptic function $f$ can be expressed in the form
\[
  f(z) = R_1[\wp(z)] + \wp'(z) R_2[\wp(z)]
\]
where $R_1$ and $R_2$ are rational functions and $\wp$ has the same set of periods as $f$.} \\



\emph{Proof.}
  \begin{align*}
    f(z)
    =&\:
    \underbrace{\frac{f(z)+f(-z)}{2}}_{\text{even}}
      + \wp'(z) \underbrace{\frac{f(z)-f(-z)}{2 \wp'(z)}}_{\text{even}} \\
    =&\: R_1[\wp(z)] + \wp'(z) R_2[\wp(z)]
      \text{ for some rational functions $R_1, R_2$}
  \end{align*}
  (by Exercise 1.4).
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.6.}
\addcontentsline{toc}{subsubsection}{Exercise 1.6.}
\emph{Let $f$ and $g$ be two elliptic functions with the same set of periods.
Prove that there exists a polynomial $P(x,y)$, not identically zero, such that
\[
  P[f(z),g(z)] = C
\]
where $C$ is a constant (depending on $f$ and $g$ but not on $z$).} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  By Exercise 1.5, we have
  \[
    f(z) = R_1[\wp(z)] + \wp'(z) R_2[\wp(z)]
  \]
  for some rational functions $R_1, R_2$
  and $\wp$ has the same set of periods as $f$.
  By cleaning the denominators of $R_1$ and $R_2$,
  we might assume
  \[
    S[\wp(z)] f(z) = R_1[\wp(z)] + \wp'(z) R_2[\wp(z)]
  \]
  for some polynomials $R_1, R_2, S$.

\item[(2)]
  So
  \begin{align*}
    &\:
    \wp'(z) R_2[\wp(z)] = S[\wp(z)] f(z) - R_1[\wp(z)] \\
    \Longrightarrow &\:
    \wp'(z)^2 R_2[\wp(z)]^2 = (S[\wp(z)] f(z) - R_1[\wp(z)])^2 \\
    \Longrightarrow &\:
    (4 \wp(z)^3 - 60G_4 \wp(z) -  140G_6) R_2[\wp(z)]^2 \\
    &\: = (S[\wp(z)] f(z) - R_1[\wp(z)])^2.
      &(\text{Theorem 1.12}) \\
    \Longrightarrow &\:
    F(\wp(z), f(z)) = 0
  \end{align*}
  for some polynomials $F(x,y) \in \mathbb{C}[x,y]$.
  Note that $F(x,y)$ is of degree $2$ if we view $F \in (\mathbb{C}[x])[y]$.

\item[(3)]
  Similarly,
  \[
    G(\wp(z), g(z)) = 0
  \]
  for some polynomials $G(x,y) \in \mathbb{C}[x,y]$.

\item[(4)]
  Let $P = \mathrm{Res}_{x}(F, G)$ be
  the resultant of two polynomials $F$ and $G$ with respect t $x$ to eliminate $\wp(z)$.
  Note that $P$ is a nonzero polynomial (since $F$ and $G$ are nonzero)
  and $P[f(z),g(z)] = 0$.
  So $P$ is our desired polynomial.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.7.}
\addcontentsline{toc}{subsubsection}{Exercise 1.7.}
\emph{The discriminant of the polynomial $f(x) = 4(x-x_1)(x-x_2)(x-x_3)$
is the product $16 \{(x_2-x_1)(x_3-x_2)(x_3-x_1)\}^2$.
Prove that the discriminant of $f(x) = 4x^3 - ax - b$ is $a^3 - 27b^2$.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Since
  \[
    f'(x) = 4(x-x_2)(x-x_3) + 4(x-x_1)(x-x_3) + 4(x-x_1)(x-x_2),
  \]
  we have
  \begin{align*}
    f'(x_1) &= 4(x_1-x_2)(x_1-x_3), \\
    f'(x_2) &= 4(x_2-x_1)(x_2-x_3), \\
    f'(x_3) &= 4(x_3-x_1)(x_3-x_2).
  \end{align*}
  Hence
  \[
    f'(x_1)f'(x_2)f'(x_3) = -4 \mathrm{disc}(f)
  \]
  where $\mathrm{disc}(f)$ is the discriminant of $f(x)$.

\item[(2)]
  As $f(x) = 4x^3 - ax - b$, we have $f'(x) = 12x^2 - a$.
  So
  \[
    f'(x_1)f'(x_2)f'(x_3) = (12x_1^2 - a)(12x_2^2 - a)(12x_3^2 - a).
  \]
  Note that
  \begin{align*}
    x_1 x_2 x_3 &= \frac{b}{4}, \\
    x_1 x_2 + x_2 x_3 + x_3 x_1 &= -\frac{a}{4}, \\
    x_1 + x_2 + x_3 &= 0,
  \end{align*}
  we have
  \begin{align*}
    x_1^2 x_2^2 x_3^2
    &= \frac{b^2}{4^2}, \\
    x_1^2 x_2^2 + x_2^2 x_3^2 + x_3^2 x_1^2
    &= (x_1 x_2 + x_2 x_3 + x_3 x_1)^2 - 2 x_1 x_2 x_3(x_1 + x_2 + x_3) \\
    &= \frac{a^2}{4^2}, \\
    x_1^2 + x_2^2 + x_3^2
    &= (x_1 + x_2 + x_3)^2 - 2(x_1 x_2 + x_2 x_3 + x_3 x_1) \\
    &= \frac{a}{2}.
  \end{align*}

\item[(3)]
  Hence
  \begin{align*}
    f'(x_1)f'(x_2)f'(x_3)
    =&\: (12x_1^2 - a)(12x_2^2 - a)(12x_3^2 - a) \\
    =&\: 12^3 (x_1^2 x_2^2 x_3^2) - 12^2 a(x_1^2 x_2^2 + x_2^2 x_3^2 + x_3^2 x_1^2) \\
      &\: + 12 a^2(x_1^2 + x_2^2 + x_3^2) - a^3 \\
    =&\: 12^3 \cdot \frac{b^2}{4^2} - 12^2 a \cdot \frac{a^2}{4^2}
      + 12 a^2 \cdot \frac{a}{2} - a^3 \\
    =&\: -4(a^3 - 27b^2).
  \end{align*}
  Therefore
  \[
    \mathrm{disc}(4x^3 - ax - b) = a^3 - 27b^2.
  \]
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.8.}
\addcontentsline{toc}{subsubsection}{Exercise 1.8.}
\emph{The differential equation for $\wp$ shows that $\wp'(z) = 0$ if
$z = \frac{\omega_1}{2}, \frac{\omega_2}{2}$ or $\frac{\omega_1+\omega_2}{2}$.
Show that
\[
  \wp''\left( \frac{\omega_1}{2} \right)
  = 2(e_1-e_2)(e_1-e_3)
\]
and obtain corresponding formulas for $\wp''\left( \frac{\omega_2}{2} \right)$ and
$\wp''\left( \frac{\omega_1+\omega_2}{2} \right)$.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Differentiation of the equation
  \[
    4 \wp(z)^3 - g_2 \wp(z) - g_3
    = 4 (\wp(z) - e_1)(\wp(z) - e_2)(\wp(z) - e_3)
  \]
  in Theorem 1.14 to get
  \begin{align*}
    12 \wp(z)^2 \wp'(z) - g_2 \wp'(z)
    =&\: 4 \wp'(z) (\wp(z) - e_2)(\wp(z) - e_3) \\
      &\: + 4 \wp'(z) (\wp(z) - e_1)(\wp(z) - e_3) \\
      &\: + 4 \wp'(z) (\wp(z) - e_1)(\wp(z) - e_2).
  \end{align*}
  Since $\wp''(z) = 6 \wp(z)^2 - \frac{g_2}{2}$,
  we have
  \begin{align*}
    \wp''(z)
    =&\: 2 (\wp(z) - e_2)(\wp(z) - e_3) \\
      &\: + 2 (\wp(z) - e_1)(\wp(z) - e_3) \\
      &\: + 2 (\wp(z) - e_1)(\wp(z) - e_2).
  \end{align*}

\item[(2)]
  Hence
  \begin{align*}
    \wp''\left( \frac{\omega_1}{2} \right)
    &= 2(e_1-e_2)(e_1-e_3), \\
    \wp''\left( \frac{\omega_2}{2} \right)
    &= 2(e_2-e_1)(e_2-e_3), \\
    \wp''\left( \frac{\omega_1 + \omega_2}{2} \right)
    &= 2(e_3-e_1)(e_3-e_2).
  \end{align*}
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.9.}
\addcontentsline{toc}{subsubsection}{Exercise 1.9.}
\emph{According to Exercise 1.4, the function $\wp(2z)$ is a rational function of $\wp(z)$.
Prove that, in fact,}
\[
  \wp(2z)
  =
  \frac{\{ \wp(z)^2 + \frac{1}{4} g_2 \}^2 + 2 g_3 \wp(z)}{4 \wp(z)^3 - g_2 \wp(z) - g_3}
  =
  - 2 \wp(z) + \frac{1}{4}\left( \frac{\wp''(z)}{\wp'(z)} \right)^2.
\] \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  By $\wp'(z)^2 = 4 \wp(z)^3 - g_2 \wp(z) - g_3$ and $\wp''(z) = 6\wp(z)^2 - \frac{1}{2} g_2$,
  we have
  \begin{align*}
    & \:
    - 2 \wp(z) + \frac{1}{4}\left( \frac{\wp''(z)}{\wp'(z)} \right)^2 \\
    = &\: 
    - 2 \wp(z) + \frac{1}{4} \cdot \frac{(6\wp(z)^2 - \frac{1}{2} g_2)^2}{4 \wp(z)^3 - g_2 \wp(z) - g_3} \\
    = &\: 
    \frac{- 2 \wp(z)[4 \wp(z)^3 - g_2 \wp(z) - g_3] + \frac{1}{4}(6\wp(z)^2 - \frac{1}{2} g_2)^2}
      {4 \wp(z)^3 - g_2 \wp(z) - g_3} \\
    = &\: 
    \frac{\wp(z)^4 + \frac{1}{2} g_2 \wp(z)^2 + \frac{1}{16}g_2^2 + 2 g_3 \wp(z)}
      {4 \wp(z)^3 - g_2 \wp(z) - g_3} \\
    = &\: 
    \frac{\{ \wp(z)^2 + \frac{1}{4}g_2 \}^2 + 2 g_3 \wp(z)}
      {4 \wp(z)^3 - g_2 \wp(z) - g_3}.
  \end{align*}
  So it suffices to show that
  $\wp(2z) = - 2 \wp(z) + \frac{1}{4}\left( \frac{\wp''(z)}{\wp'(z)} \right)^2.$

\item[(2)]
  Let $\Omega$ be the lattice generated by periods of $\wp$.
  Suppose the addition theorem of $\wp$ holds, that is,
  \[
    \wp(u) + \wp(v) + \wp(u+v)
    =
    \frac{1}{4}\left( \frac{\wp'(u)-\wp'(v)}{\wp(u)-\wp(v)} \right)^2
  \]
  with $u, v, u+v \not\equiv 0 \pmod{\Omega}$.
  Then letting $v$ to $u$, we have
  \begin{align*}
    \wp(2u)
    &= \lim_{v \to u} \wp(u + v) \\
    &= \lim_{v \to u}
      \left\{ -\wp(u)-\wp(v)+\frac{1}{4}\left( \frac{\wp'(u)-\wp'(v)}{\wp(u)-\wp(v)} \right)^2 \right\} \\
    &= -2\wp(u) + \frac{1}{4} \lim_{v \to u} \frac{\wp'(v)-\wp'(u)}{\wp(v)-\wp(u)} \\
    &=  -2\wp(u) + \frac{1}{4}\left( \frac{\wp''(u)}{\wp'(u)} \right)^2.
  \end{align*}
  The last equality is followed by L'Hospital's rule.
  So it suffices to show the addition theorem of $\wp$ is true.

\item[(3)]
  \emph{Let $u + v + w = 0$, with $u, v, w \not\equiv 0 \pmod{\Omega}$.
  Show that}
  \[
    \begin{vmatrix}
      \wp(u) & \wp'(u) & 1 \\
      \wp(v) & \wp'(v) & 1 \\
      \wp(w) & \wp'(w) & 1
    \end{vmatrix} = 0.
  \]
  Consider the elliptic function
  \[
    f(z) := \wp'(z)
      - \underbrace{\frac{\wp'(u)-\wp'(v)}{\wp(u)-\wp(v)}}_{:= A} \wp(z)
      - \underbrace{\frac{\wp(u)\wp'(v) - \wp(v)\wp'(u)}{\wp(u)-\wp(v)}}_{:= B}.
  \]
  $f$ has exactly $3$ zeros in a period parallelogram as $f$ has order $3$.
  Note that $f$ has a pole at $0$ of order $3$.
  By Exercise 1.2, the sum of the zeros is equal to the sum of poles in a period parallelogram.
  Since $u$ and $v$ are zeros of $f$ (by verifying $f(u) = f(v) = 0$ directly),
  the third zero must be $-u-v = w$.
  Hence there is a line
  \[
      y = A x + B
  \]
  passing through $3$ points $(\wp(u),\wp'(u))$, $(\wp(v),\wp'(v))$ and $(\wp(w),\wp'(w))$.
  So the determinant is zero.

\item[(4)]
  Now we are going to remove the term $\wp'(w)$ to prove the addition theorem of $\wp$.
  By Theorem 1.12, we have the system of equations
  \begin{equation*}
    \begin{cases}
       y = A x + B, \\
       y^2 = 4x^3 - g_2 x - g_3,
    \end{cases}
  \end{equation*}
  where $(x,y) = (\wp(z), \wp'(z))$.
  Hence
  \begin{align*}
    &\:
    (A x + B)^2 = 4x^3 - g_2 x - g_3 \\
    \Longleftrightarrow & \:
    4x^3 - A^2 x^2 - (2AB + g_2) x - (B^2 + g_3) = 0 \\
    \Longrightarrow & \:
    \text{sum of three roots of $x$ is $\frac{A^2}{4}$} \\
    \Longrightarrow & \:
    \wp(u) + \wp(v) + \wp(w) = \frac{1}{4}\left( \frac{\wp'(u)-\wp'(v)}{\wp(u)-\wp(v)} \right)^2 \\
    \Longrightarrow & \:
    \wp(-u-v) = - \wp(u) - \wp(v) + \frac{1}{4}\left( \frac{\wp'(u)-\wp'(v)}{\wp(u)-\wp(v)} \right)^2 \\
    \Longrightarrow & \:
    \wp(u+v) = - \wp(u) - \wp(v) + \frac{1}{4}\left( \frac{\wp'(u)-\wp'(v)}{\wp(u)-\wp(v)} \right)^2.
      &(\text{$\wp$: even})
  \end{align*}
  So the addition theorem of $\wp$ is established.
\end{enumerate}
$\Box$ \\



\emph{Note.}
\begin{enumerate}
\item[(1)]
  In the proof, part (4) is similar to defining an addition $\oplus$
  on a nonsingular cubic $E$ in $\mathbf{P}^2(k)$.
  It is equivalent to defining the divisor class group on $E$.
  See Problem 8.6 in the textbook: \emph{William Fulton, Algebraic Curves}.

\item[(2)]
  If $E \in \mathbf{P}^2(\mathbb{C})$ is the elliptic curve corresponding to the lattice $\Omega$,
  then there is an isomorphism
  \[
    \alpha: \mathbb{C}/\Omega \longrightarrow E: y^2 z = 4x^3 - g_2 xz^2 - g_3 z^3
  \]
  defined by
  \begin{equation*}
    \alpha(z) =
    \begin{cases}
       [\wp(z):\wp'(z):1] &\text{if $z \neq 0 \in \Omega$}, \\
       [0:1:0] &\text{if $z = 0 \in \Omega$},
    \end{cases}
  \end{equation*}
  such that $\alpha$ is both analytic (as a mapping of complex manifolds) and
  algebraic (as a homomorphism of groups). \\\\
\end{enumerate}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.10.}
\addcontentsline{toc}{subsubsection}{Exercise 1.10.}
\emph{Let $\omega_1$ and $\omega_2$ be complex numbers with nonreal ratio.
Let $f(z)$ be an entire function and assume there are constants $a$ and $b$ such that
\[
  f(z+\omega_1) = af(z), \qquad f(z+\omega_2) = bf(z),
\]
for all $z$.
Prove that $f(z) = A e^{Bz}$, where $A$ and $B$ are constant.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Might assume that $a \neq 0$ and $b \neq 0$
  (otherwise $f = 0$ on $\mathbb{C}$).

\item[(2)]
  Define
  \[
    g(z) := \frac{f(z)}{e^{Bz}}.
  \]
  It suffices to show $g$ is a constant.
  Note that $g(z)$ is entire (since $f$ and $e^{Bz} \neq 0$ are entire).
  By Theorem 1.4, it suffices to show $g$ is doubly periodic, that is,
  to show
  \[
    g(z+\omega_1) = g(z) \text{ and } g(z+\omega_2) = g(z)
  \]
  for suitable $B$.

\item[(3)]
  Note that
  \begin{align*}
    &\:
    g(z+\omega_1) = g(z) \text{ and } g(z+\omega_2) = g(z) \\
    \Longleftrightarrow & \:
    \frac{a}{e^{B\omega_1}} \cdot g(z) = g(z)
      \text{ and } \frac{b}{e^{B\omega_2}} \cdot g(z) = g(z) \\
    \Longleftrightarrow & \:
    e^{B\omega_1} = a \text{ and } e^{B\omega_2} = b \\
    \Longleftrightarrow & \:
    \text{$\exists \: B$ such that $e^{B\omega_1} = a$ and $e^{B\omega_2} = b$}.
  \end{align*}
  Take $B$ such that $e^{B(\omega_1 - \omega_2)} = \frac{a}{b}$
  (since $\frac{a}{b}$ is well-defined, $\omega_1 - \omega_2 \neq 0$,
  and $z \mapsto \exp(z)$ is a onto map from $\mathbb{C}$ to $\mathbb{C} \smallsetminus \{0\}$).
  Hence $g$ is doubly periodic.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.11.}
\addcontentsline{toc}{subsubsection}{Exercise 1.11.}
\emph{If $k \geq 2$ and $\tau \in H$ prove that the Eisenstein series
\[
  G_{2k}(\tau)
  = \sum_{(m,n) \neq (0,0)} (m+n\tau)^{-2k}
\]
has the Fourier expansion
}
\[
  G_{2k}(\tau)
  =
  2 \zeta(2k) + \frac{2(2\pi i)^{2k}}{(2k-1)!} \sum_{n=1}^{\infty} \sigma_{2k-1}(n) e^{2\pi i n \tau}.
\] \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Let $q = e^{2 \pi i \tau}$.
  Similar to Lemma 1.3 on page 19, we have
  \[
    (2k-1)! \sum_{m=-\infty}^{+\infty} \frac{1}{(\tau+m)^{2k}}
    = (2 \pi i)^{2k} \sum_{r=1}^{\infty} r^{2k-1} q^r.
  \]

\item[(2)]
  Similar to Theorem 1.18, we have
  \begin{align*}
    G_{2k}(\tau)
    &= \sum_{(m,n) \neq (0,0)} (m+n\tau)^{-2k} \\
    &= \sum_{\substack{m=-\infty \\ m \neq 0 (n = 0)}}^{+\infty} m^{-2k}
      + \sum_{n=1}^{\infty} \sum_{m=-\infty}^{+\infty} ((m+n\tau)^{-2k} + (m-n\tau)^{-2k}) \\
    &= 2 \zeta(2k)
      + 2 \sum_{n=1}^{\infty} \sum_{m=-\infty}^{+\infty} (m+n\tau)^{-2k} \\
    &= 2 \zeta(2k)
      + 2 \sum_{n=1}^{\infty} \frac{(2\pi i)^{2k}}{(2k-1)!}
        \sum_{r=1}^{\infty} r^{2k-1} q^{nr} \\
    &= 2 \zeta(2k)
      + \frac{2(2\pi i)^{2k}}{(2k-1)!} \sum_{n=1}^{\infty}
        \underbrace{\sum_{d|n} d^{2k-1}}_{= \sigma_{2k-1}(n)} q^{n}.
  \end{align*}
  In the last double sum we collect together those terms for which $nr$ is constant.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.12.}
\addcontentsline{toc}{subsubsection}{Exercise 1.12.}
\emph{Refer to Exercise 1.11. If $\tau \in H$ prove that
\[
  G_{2k}\left(-\frac{1}{\tau}\right) = \tau^{2k} G_{2k}(\tau)
\]
and deduce that
\begin{align*}
  G_{2k}\left(\frac{i}{2}\right) &= (-4)^k G_{2k}(2i)
    &\text{for all $k \geq 2$}, \\
  G_{2k}(i) &= 0
    &\text{if $k$ is odd}, \\
  G_{2k}(e^{\frac{2\pi i}{3}}) &= 0
    &\text{if $k \not\equiv 0 \pmod{3}$}.
\end{align*}}



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  \begin{align*}
    G_{2k}\left(-\frac{1}{\tau}\right)
    &= \sum_{(m,n) \neq (0,0)} \left(m - \frac{n}{\tau}\right)^{-2k} \\
    &= \tau^{2k} \sum_{(m,n) \neq (0,0)} (\tau m - n)^{-2k} \\
    &= \tau^{2k} G_{2k}(\tau).
  \end{align*}

\item[(2)]
  Let $\tau = 2i$.
  We have $G_{2k}\left(\frac{i}{2}\right) = (-4)^k G_{2k}(2i)$.

\item[(3)]
  Let $\tau = i$.
  We have $G_{2k}(i) = (-1)^k G_{2k}(i)$.
  Hence $G_{2k}(i) = 0$ if $k$ is odd.

\item[(4)]
  Let $\tau = e^{\frac{\pi i}{3}}$.
  We have $G_{2k}(e^{\frac{2\pi i}{3}}) = e^{\frac{2k \pi i}{3}} G_{2k}(e^{\frac{\pi i}{3}})$.
  Since
  \[
    e^{\frac{2\pi i}{3}} = -1 + e^{\frac{\pi i}{3}}
  \]
  and each Eisenstein series is a periodic function of $\tau$ of period $1$,
  we have $G_{2k}(e^{\frac{2\pi i}{3}}) = G_{2k}(e^{\frac{\pi i}{3}})$.
  So $G_{2k}(e^{\frac{2\pi i}{3}}) = e^{\frac{2k \pi i}{3}} G_{2k}(e^{\frac{2\pi i}{3}})$.
  Therefore $G_{2k}(e^{\frac{2\pi i}{3}}) = 0$ if $k \not\equiv 0 \pmod{3}$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.13.}
\addcontentsline{toc}{subsubsection}{Exercise 1.13.}
\emph{Ramanujan's tau function $\tau(n)$ is defined by the Fourier expansion
\[
  \Delta(\tau)
  =
  (2\pi)^{12} \sum_{n=1}^{\infty} \tau(n) e^{2\pi i n \tau},
\]
derived in Theorem 1.19.
Prove that
\[
  \tau(n)
  =
  8000 \{ (\sigma_3 \circ \sigma_3) \circ \sigma_3 \}(n)
  - 147( \sigma_5 \circ \sigma_5 )(n),
\]
where $f \circ g$ denotes the Cauchy product of two sequences,
\[
  (f \circ g)(n) = \sum_{k=0}^{n} f(k)g(n-k),
\]
and $\sigma_\alpha(n) = \sum_{d|n} d^{\alpha}$ for $n \geq 1$,
with $\sigma_3(0) = \frac{1}{240}$, $\sigma_5(0) = -\frac{1}{504}$.
(Hint: Theorem 1.18.)} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Let $q = e^{2 \pi i \tau}$.
  Write
  \begin{align*}
    g_2(\tau)
    &=
    \frac{4\pi^4}{3} \left\{ 1 + 240 \sum_{k=1}^{\infty} \sigma_3(k) q^k \right\}
    = \frac{4\pi^4}{3} \left\{ 240 \sum_{k=0}^{\infty} \sigma_3(k) q^k \right\}, \\
    g_3(\tau)
    &=
    \frac{8\pi^6}{27} \left\{ 1 - 504 \sum_{k=1}^{\infty} \sigma_5(k) q^k \right\}
    = \frac{8\pi^6}{27} \left\{ -504 \sum_{k=0}^{\infty} \sigma_5(k) q^k \right\}
  \end{align*}
  (Theorem 1.18).

\item[(2)]
  Similar to the proof of Theorem 1.19,
  \begin{align*}
    \Delta(\tau)
    =&\:
    g_2(\tau)^3 - 27 g_3(\tau)^2 \\
    =&\:
    \frac{64 \pi^{12}}{27}
      \left\{ \left( 240 \sum_{k=0}^{\infty} \sigma_3(k) q^k \right)^3
        - \left( -504 \sum_{k=0}^{\infty} \sigma_5(k) q^k \right)^2 \right\} \\
    =&\:
    (2\pi)^{12} \left\{ 8000 \left( \sum_{k=0}^{\infty} \sigma_3(k) q^k \right)^3
      - 147 \left( \sum_{k=0}^{\infty} \sigma_5(k) q^k \right)^2 \right\} \\
    =&\:
      (2\pi)^{12} \sum_{n=0}^{\infty}
        \left\{ 8000 \{ (\sigma_3 \circ \sigma_3) \circ \sigma_3 \}(n)
        - 147 ( \sigma_5 \circ \sigma_5 )(n) \right\} q^n \\
    =&\:
      (2\pi)^{12} \sum_{n=1}^{\infty}
        \left\{ 8000 \{ (\sigma_3 \circ \sigma_3) \circ \sigma_3 \}(n)
        - 147 ( \sigma_5 \circ \sigma_5 )(n) \right\} q^n.
  \end{align*}
  (Here $8000 \{ (\sigma_3 \circ \sigma_3) \circ \sigma_3 \}(0)
    - 147 ( \sigma_5 \circ \sigma_5 )(0) = 0$.)

\item[(3)]
  Therefore
  \[
    \tau(n)
    =
    8000 \{ (\sigma_3 \circ \sigma_3) \circ \sigma_3 \}(n)
      - 147 ( \sigma_5 \circ \sigma_5 )(n)
  \]
  for $n \geq 1$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.14. (Lambert series)}
\addcontentsline{toc}{subsubsection}{Exercise 1.14. (Lambert series)}
\emph{A series of the form $\sum_{n=1}^{\infty} f(n)\frac{x^n}{1-x^n}$
is called a \textbf{Lambert series}.
Assuming absolute convergence, prove that
\[
  \sum_{n=1}^{\infty} f(n)\frac{x^n}{1-x^n}
  = \sum_{n=1}^{\infty} F(n)x^n,
\]
where
\[
  F(n) = \sum_{d \mid n} f(d).
\]
Apply this result to obtain the following formulas, valid for $|x| < 1$.}
\begin{enumerate}
\item[(a)]
  \[
    \sum_{n=1}^{\infty} \frac{\mu(n)x^n}{1-x^n} = x.
  \]

\item[(b)]
  \[
    \sum_{n=1}^{\infty} \frac{\varphi(n)x^n}{1-x^n} = \frac{x}{(1-x)^2}.
  \]

\item[(c)]
  \[
    \sum_{n=1}^{\infty} \frac{n^{\alpha}x^n}{1-x^n}
    = \sum_{n=1}^{\infty} \sigma_{\alpha}(n)x^n.
  \]

\item[(d)]
  \[
    \sum_{n=1}^{\infty} \frac{\lambda(n)x^n}{1-x^n} = \sum_{n=1}^{\infty} x^{n^2}.
  \]

\item[(e)]
  \emph{Use the result in (c) to express $g_2(\tau)$ and $g_3(\tau)$
  in terms of Lambert series in $x = e^{2\pi i \tau}$.} \\
\end{enumerate}
\emph{Note. In (a), $\mu(n)$ is the M\"obius function;
In (b), $\varphi(n)$ is Euler's totient;
and in (d), $\lambda(n)$ is Liouville's function.} \\



\emph{Proof.}
  Similar to the proof of Exercise 1.11.
  \begin{align*}
    \sum_{n=1}^{\infty} f(n)\frac{x^n}{1-x^n}
    &= \sum_{n=1}^{\infty} f(n) \sum_{r=1}^{\infty} x^{rn} \\
    &= \sum_{n=1}^{\infty} \sum_{r=1}^{\infty} f(n) x^{rn} \\
    &= \sum_{n=1}^{\infty} \underbrace{\left( \sum_{d|n} f(d) \right)}_{= F(n)} x^n.
  \end{align*}
$\Box$ \\



\emph{Proof of (a).}
  Theorem 2.1 in the textbook: \emph{T. M. Apostol, Introduction to Analytic Number Theory}
  shows that
  \begin{equation*}
    F(n) := \sum_{d \mid n} \mu(d) =
    \begin{cases}
      1 & \text{if $n = 1$}, \\
      0 & \text{if $n > 1$}.
    \end{cases}
  \end{equation*}
  Hence
  \[
    \sum_{n=1}^{\infty} \mu(n)\frac{x^n}{1-x^n}
    = \sum_{n=1}^{\infty} F(n)x^n
    = x.
  \]
$\Box$ \\



\emph{Proof of (b).}
  Theorem 2.2 in the textbook: \emph{T. M. Apostol, Introduction to Analytic Number Theory}
  shows that $F(n) := \sum_{d \mid n} \varphi(d) = n$.
  Hence
  \[
    \sum_{n=1}^{\infty} \varphi(n)\frac{x^n}{1-x^n}
    = \sum_{n=1}^{\infty} F(n)x^n
    = \sum_{n=1}^{\infty} n x^n
    = \frac{x}{(1-x)^2}.
  \]
$\Box$ \\\\



\emph{Proof of (c).}
  Since
  \[
    F(n) := \sum_{d \mid n} d^{\alpha} = \sigma_\alpha(n),
  \]
  we have
  \[
    \sum_{n=1}^{\infty} n^{\alpha}\frac{x^n}{1-x^n}
    = \sum_{n=1}^{\infty} F(n)x^n
    = \sum_{n=1}^{\infty} \sigma_\alpha(n) x^n.
  \]
$\Box$ \\



\emph{Proof of (d).}
  Theorem 2.19 in the textbook: \emph{T. M. Apostol, Introduction to Analytic Number Theory}
  shows that
  \begin{equation*}
    F(n) := \sum_{d \mid n} \lambda(d) =
    \begin{cases}
      1 & \text{if $n$ is a square}, \\
      0 & \text{otherwise}.
    \end{cases}
  \end{equation*}
  Hence
  \[
    \sum_{n=1}^{\infty} \lambda(n)\frac{x^n}{1-x^n}
    = \sum_{n=1}^{\infty} F(n)x^n
    = \sum_{n=1}^{\infty} x^{n^2}.
  \]
$\Box$ \\



\emph{Proof of (e).}
\begin{enumerate}
\item[(1)]
  Let $q = x = e^{2\pi i \tau}$.
  \begin{align*}
    g_2(\tau)
    &= \frac{4\pi^4}{3} \left\{ 1 + 240 \sum_{k=1}^{\infty} \sigma_3(k) q^k \right\}
      &(\text{Theorem 1.18}) \\
    &= \frac{4\pi^4}{3} \left\{ 1 + 240 \sum_{k=1}^{\infty} \frac{k^3 q^k}{1-q^k} \right\}
      &(\text{(c)}).
  \end{align*}

\item[(2)]
  Similarly,
  \begin{align*}
    g_3(\tau)
    &= \frac{8\pi^6}{27} \left\{ 1 - 504 \sum_{k=1}^{\infty} \sigma_5(k) q^k \right\}
      &(\text{Theorem 1.18}) \\
    &= \frac{8\pi^6}{27} \left\{ 1 - 504 \sum_{k=1}^{\infty} \frac{k^5 q^k}{1-q^k} \right\}
      &(\text{(c)}).
  \end{align*}
\end{enumerate}
$\Box$ \\



\emph{Note.}
\begin{enumerate}
\item[(1)]
  \[
    \sum_{n=1}^{\infty} \frac{\Lambda(n)x^n}{1-x^n}
    = \sum_{n=1}^{\infty} \log(n) x^n,
  \]
  where $\Lambda(n)$ is von Mangoldt function.

\item[(2)]
  Similar to Exercise 1.15,
  we have a similar formula for (a)
  \[
    \sum_{n=1}^{\infty} \frac{\mu(n)x^n}{1+x^n} = x-2x^2
  \]
  by noting that
  \[
    \sum_{n=1}^{\infty} \frac{f(n)x^n}{1+x^n}
    =
    \sum_{n=1}^{\infty} \frac{f(n)x^n}{1-x^n} - 2 \sum_{n=1}^{\infty} \frac{f(n)x^{2n}}{1-x^{2n}}.
  \] \\
\end{enumerate}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 1.15.}
\addcontentsline{toc}{subsubsection}{Exercise 1.15.}
\emph{Let
\[
  G(x) = \sum_{n=1}^{\infty} \frac{n^5 x^n}{1-x^n},
\]
and let
\[
  F(x) = \sum_{\substack{n=1 \\ (\text{$n$ odd})}}^{\infty} \frac{n^5 x^n}{1+x^n}.
\]}
\begin{enumerate}
\item[(a)]
  \emph{Prove that $F(x) = G(x) - 34G(x^2) + 64(x^4)$.}

\item[(b)]
  \emph{Prove that
  \[
    \sum_{\substack{n=1 \\ (\text{$n$ odd})}}^{\infty} \frac{n^5}{1+e^{n\pi}}
    = \frac{31}{504}.
  \]}

\item[(c)]
  \emph{Use Theorem 12.17 in the textbook: T. M. Apostol, Introduction to Analytic Number Theory
  to prove the more general result}
  \[
    \sum_{\substack{n=1 \\ (\text{$n$ odd})}}^{\infty} \frac{n^{4k+1}}{1+e^{n\pi}}
    = \frac{2^{4k+1}-1}{8k+4}B_{4k+2}.
  \]
\end{enumerate}



\emph{Proof of (a).}
\begin{enumerate}
\item[(1)]
  Consider the general case.
  \emph{Let
  \[
    G(x) = \sum_{n=1}^{\infty} \frac{n^{4k+1} x^n}{1-x^n},
  \]
  and let
  \[
    F(x) = \sum_{\substack{n=1 \\ (\text{$n$ odd})}}^{\infty} \frac{n^{4k+1} x^n}{1+x^n}.
  \]
  Show that $F(x) = G(x) - (2^{4k+1} + 2)G(x^2) + 2^{4k+2} G(x^4)$.}

\item[(2)]
  The identity
  \[
    \sum_{n=1}^{\infty} \frac{x^n}{1+x^n}
    = \sum_{n=1}^{\infty} \frac{x^n}{1-x^n}
      - 2 \sum_{n=1}^{\infty} \frac{x^{2n}}{1-x^{2n}}
  \]
  is always true.
  Hence $H(x) := \sum_{n=1}^{\infty} \frac{n^{4k+1} x^n}{1+x^n} = G(x) - 2G(x^2)$.

\item[(3)]
  Note that
  \begin{align*}
    H(x)
    &=
    \sum_{\substack{n=1 \\ (\text{$n$ odd})}}^{\infty} \frac{n^{4k+1} x^n}{1+x^n}
    + \sum_{\substack{n=1 \\ (\text{$n$ even})}}^{\infty} \frac{n^{4k+1} x^n}{1+x^n} \\
    &=
    F(x) + \sum_{n=1}^{\infty} \frac{(2n)^{4k+1} x^{2n}}{1+x^{2n}} \\
    &=
    F(x) + 2^{4k+1} \sum_{n=1}^{\infty} \frac{n^{4k+1} x^{2n}}{1+x^{2n}} \\
    &=
    F(x) + 2^{4k+1}H(x^2).
  \end{align*}
  Hence
  \begin{align*}
    F(x)
    &= H(x) - 2^{4k+1}H(x^2) \\
    &= [G(x) - 2G(x^2)] - 2^{4k+1}[G(x^2) - 2G(x^4)] \\
    &= G(x) - (2^{4k+1} + 2)G(x^2) + 2^{4k+2}G(x^4).
  \end{align*}
\end{enumerate}
$\Box$ \\



\emph{Proof of (b).}
  Take $k = 1$ in part (c), we have
  \[
    \sum_{\substack{n=1 \\ (\text{$n$ odd})}}^{\infty} \frac{n^5}{1+e^{n\pi}}
    = \frac{31}{12} \cdot \frac{1}{42}
    = \frac{31}{504}.
  \]
$\Box$ \\



\emph{Proof of (c).}
\begin{enumerate}
\item[(1)]
  Let $q = e^{2 \pi i \tau}$.
  So
  \begin{align*}
    G_{4k+2}(\tau)
    &=
    2 \zeta(4k+2)
      + \frac{2(2\pi i)^{4k+2}}{(4k+1)!} \sum_{n=1}^{\infty} \sigma_{4k+1}(n) q^n
      &(\text{Exercise 1.11}) \\
    &=
    2 \zeta(4k+2)
      + \frac{2(2\pi i)^{4k+2}}{(4k+1)!} G(q)
      &(\text{Exercise 1.14(c)})
  \end{align*}
  Hence
  \begin{align*}
    & \:
    G_{4k+2}(\tau) - (2^{4k+1} + 2) G_{4k+2}(2\tau) + 2^{4k+2} G_{4k+2}(4\tau) \\
    = &\:
      \left[ 2 \zeta(4k+2)
        + \frac{2(2\pi i)^{4k+2}}{(4k+1)!} G(q) \right] \\
    &\:
      - (2^{4k+1} + 2) \left[ 2 \zeta(4k+2)
        + \frac{2(2\pi i)^{4k+2}}{(4k+1)!} G(q^2) \right] \\
    &\:
      + 2^{4k+2} \left[ 2 \zeta(4k+2)
        + \frac{2(2\pi i)^{4k+2}}{(4k+1)!} G(q^4) \right] \\
    = &\:
    (1 - (2^{4k+1} + 2) + 2^{4k+2}) \cdot 2\zeta(4k+2) \\
    &\:
      + \frac{2(2\pi i)^{4k+2}}{(4k+1)!}
        [G(q) - (2^{4k+1} + 2)G(q^2) + 2^{4k+2}G(q^4)] \\
    = &\:
    (2^{4k+2} - 2) \zeta(4k+2)
      + \frac{2(2\pi i)^{4k+2}}{(4k+1)!} F(q).
  \end{align*}

\item[(2)]
  By taking $\tau = \frac{i}{2}$, we have
  \[
    F(q)
    = F(e^{-\pi})
    = \sum_{\substack{n=1 \\ (\text{$n$ odd})}}^{\infty} \frac{n^{4k+1}}{1+e^{n\pi}}
  \]
  and
  \begin{align*}
    & \:
    G_{4k+2}(\tau) - (2^{4k+1} + 2) G_{4k+2}(2\tau) + 2^{4k+2} G_{4k+2}(4\tau) \\
    = &\:
    G_{4k+2}\left( \frac{i}{2} \right)
      - (2^{4k+1} + 2) G_{4k+2}(i)
      + 2^{4k+2} G_{4k+2}(2i) \\
    = &\:
    (-4)^{2k+1} G_{4k+2}(2i) - (2^{4k+1} + 2) \cdot 0 + 2^{4k+2} G_{4k+2}(2i) \\
    = &\:
    0.
  \end{align*}
  (Exercise 1.12).
  Hence
  \[
    0 = (2^{4k+2} - 2) \zeta(4k+2)
    + \frac{2(2\pi i)^{4k+2}}{(4k+1)!}
    \sum_{\substack{n=1 \\ (\text{$n$ odd})}}^{\infty} \frac{n^{4k+1}}{1+e^{n\pi}}.
  \]

\item[(3)]
  Theorem 12.17 in the textbook: \emph{T. M. Apostol, Introduction to Analytic Number Theory}
  shows that
  \[
    \zeta(4k+2)
    = (-1)^{2k+1+1} \frac{(2\pi)^{4k+2} B_{4k+2}}{2(4k+2)!}
    = \frac{(2\pi)^{4k+2} B_{4k+2}}{2(4k+2)!}.
  \]
  Hence
  \[
    \sum_{\substack{n=1 \\ (\text{$n$ odd})}}^{\infty} \frac{n^{4k+1}}{1+e^{n\pi}}
    = \frac{2^{4k+1}-1}{8k+4}B_{4k+2}.
  \]
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\newpage
\section*{Chapter 2: The modular group and modular functions \\}
\addcontentsline{toc}{section}{Chapter 2: The modular group and modular functions}



\emph{In these exercise, $\Gamma$ denotes the modular group,
$S$ and $T$ denote its generators $S(\tau) = -\frac{1}{\tau}$, $T(\tau) = \tau + 1$,
and $I$ denotes the identity element.} \\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 2.2.}
\addcontentsline{toc}{subsubsection}{Exercise 2.2.}
\emph{Find the smallest integer $n > 0$ such that $(ST)^n = I$.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  $n = 3$.

\item[(2)]
  Write
  \[
    ST
    =
    \begin{pmatrix}
      0 & -1 \\
      1 & 0
    \end{pmatrix}
    \begin{pmatrix}
      1 & 1 \\
      0 & 1
    \end{pmatrix}
    =
    \begin{pmatrix}
      0 & -1 \\
      1 & 1
    \end{pmatrix}.
  \]
  So
  \begin{align*}
    (ST)^2
    &=
    \begin{pmatrix}
      -1 & -1 \\
      1 & 0
    \end{pmatrix}, \\
    (ST)^3
    &=
    \begin{pmatrix}
      -1 & 0 \\
      0 & -1
    \end{pmatrix} = I \in \Gamma.
  \end{align*}
  Here we identify each matrix with its negative,
  since both of them represent the same transformation.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsection*{Congruence subgroups \\}
\addcontentsline{toc}{subsection}{Congruence subgroups}



\emph{The modular group $\Gamma$ has many subgroups of special interest in number theory.
The following exercises deal with a class of subgroups call \textbf{congruence} subgroups.
Let
\[
  A =
  \begin{pmatrix}
    a & b \\
    c & d
  \end{pmatrix}
  \text{ and }
  B =
  \begin{pmatrix}
    \alpha & \beta \\
    \gamma & \delta
  \end{pmatrix}
\]
be two unimodular matrices.
(In this discussion we do not identify a matrix with its negative.)
If $n$ is a positive integer write
\[
  A \equiv B \pmod{n}
  \text{ whenever $a \equiv \alpha$, $b \equiv \beta$, $c \equiv \gamma$ and $d \equiv \delta \pmod{n}$.}
\]
This defines an equivalence relation with the property that
\[
  A_1 \equiv A_2 \pmod{n}
  \text{ and }
  B_1 \equiv B_2 \pmod{n}
\]
implies
\[
  A_1B_1 \equiv A_2B_2 \pmod{n}
  \text{ and }
  A_1^{-1} \equiv A_2^{-1} \pmod{n}.
\]
Hence
\[
  A \equiv B \pmod{n}
  \text{ if, and only if, }
  AB^{-1} \equiv I \pmod{n},
\]
where $I$ is the identity matrix.
We denote by $\Gamma^{(n)}$ the set of all matrices in $\Gamma$ congruent modulo $n$ to the identity.
This is called the \textbf{congruence subgroup of level $n$}.} \\

\emph{Prove each of the following statements:} \\\\



\subsubsection*{Exercise 2.11.}
\addcontentsline{toc}{subsubsection}{Exercise 2.11.}
\emph{$\Gamma^{(n)}$ is a subgroup of $\Gamma$.
Moreover, if $B \in \Gamma^{(n)}$ then $A^{-1}BA \in \Gamma^{(n)}$ for every $A$ in $\Gamma$.
That is, $\Gamma^{(n)}$ is a normal subgroup of $\Gamma$.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  \emph{Show that $\Gamma^{(n)}$ is a subgroup of $\Gamma$.}
  $\Gamma^{(n)} \neq \varnothing$ since $I \in \Gamma^{(n)}$.
  Suppose $A, B \in \Gamma^{(n)}$, that is, $A \equiv I \pmod{n}$ and $B \equiv I \pmod{n}$.
  Hence $AB^{-1} \equiv I I^{-1} \equiv I \pmod{n}$ or $AB^{-1} \in \Gamma^{(n)}$.

\item[(2)]
  \emph{Show that $\Gamma^{(n)}$ is normal in $\Gamma$.}
  Note that
  \[
    A^{-1}BA \equiv A^{-1}IA \equiv A^{-1}A \equiv I \pmod{n}
  \]
  for every $B \in \Gamma^{(n)}$ and $A$ in $\Gamma$.
  Hence $A^{-1}BA \in \Gamma^{(n)}$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 2.12.}
\addcontentsline{toc}{subsubsection}{Exercise 2.12.}
\emph{The quotient group $\Gamma/\Gamma^{(n)}$ is finite.
That is, there exist a finite number of elements of $\Gamma$,
say $A_1, \ldots, A_k$,
such that every $B$ in $\Gamma$ is representable in the form
\[
  B = A_i B^{(n)}
  \text{ where } 1 \leq i \leq k
  \text{ and } B^{(n)} \in \Gamma^{(n)}.
\]
The smallest such $k$ is called the index of $\Gamma^{(n)}$ in $\Gamma$.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Consider the exact sequence
  \[
    1 \to \Gamma^{(n)} \to SL_2(\mathbb{Z}) \to SL_2(\mathbb{Z}/n\mathbb{Z}) \to 1.
  \]
  The surjectivity of the residue class map is proved in Exercise 2.14.

\item[(2)]
  Hence $\Gamma/\Gamma^{(n)} \cong SL_2(\mathbb{Z}/n\mathbb{Z})$ is a finite group.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 2.13.}
\addcontentsline{toc}{subsubsection}{Exercise 2.13.}
\emph{The index of $\Gamma^{(n)}$ in $\Gamma$ is
the number of equivalence classes of matrices modulo $n$.} \\



\emph{Proof.}
  The index is the number of all cosets of $\Gamma/\Gamma^{(n)} = |SL_2(\mathbb{Z}/n\mathbb{Z})|$
  (by Exercise 2.12).
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\emph{The following exercises determine an explicit formula for the index.} \\\\



\subsubsection*{Exercise 2.14.}
\addcontentsline{toc}{subsubsection}{Exercise 2.14.}
\emph{Given integers $a, b, c, d$ with $ad - bc \equiv 1 \pmod{n}$,
there exist integers $\alpha, \beta, \gamma, \delta$ such that
$\alpha \equiv a$, $\beta \equiv b$, $\gamma \equiv c$ and $\delta \equiv d \pmod{n}$
with $\alpha\delta - \beta\gamma = 1$.} \\

It is equivalent to show that the residue class map
\[
  SL_2(\mathbb{Z}) \to SL_2(\mathbb{Z}/n\mathbb{Z})
\]
is surjective. \\

\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Might assume $a \neq 0$.
  Suppose $a = 0$, we can lift
  \[
    \begin{pmatrix}
      a & b \\
      c & d
    \end{pmatrix}
    \begin{pmatrix}
      0 & -1 \\
      1 & 0
    \end{pmatrix}
    =
    \begin{pmatrix}
      b & -a \\
      d & -c
    \end{pmatrix}
  \]
  from $SL_2(\mathbb{Z}/n\mathbb{Z})$ to $SL_2(\mathbb{Z})$ (where $b \neq 0$)
  by the following proof,
  say
  \[
    \begin{pmatrix}
      \beta & -\alpha \\
      \delta & -\gamma
    \end{pmatrix} \in SL_2(\mathbb{Z}).
  \]
  Thus
  \[
    \begin{pmatrix}
      \beta & -\alpha \\
      \delta & -\gamma
    \end{pmatrix}
    \begin{pmatrix}
      0 & 1 \\
      -1 & 0
    \end{pmatrix}
    =
    \begin{pmatrix}
      \alpha & \beta \\
      \gamma & \delta
    \end{pmatrix}
  \]
  is our desired.

\item[(2)]
  Since $ad - bc \equiv 1 \pmod{n}$,
  there is an integer $s \in \mathbb{Z}$ such that
  \[
    ad - bc + sn = 1.
  \]
  Note that $a \neq 0$ and $\gcd(a,b,n) = 1$.
  Take
  \[
    t = \prod_{\substack{p \mid a \\ p \nmid b}} p
  \]
  where $p$ is a prime factor of $a$. (We take $t = 1$ if $a = \pm 1$.)

\item[(3)]
  Hence $(a, b + tn) = 1$ by the construction of $t$ and $\gcd(a,b,n) = 1$.
  So $1$ is a linear combination of $a$ and $b + tn$.
  In particular, there exist $u, v \in \mathbb{Z}$ such that
  \[
    ua - v(b + tn) = s + tc.
  \]
  Define
  \[
    \begin{pmatrix}
      \alpha & \beta \\
      \gamma & \delta
    \end{pmatrix}
    =
    \begin{pmatrix}
      a & b + tn \\
      c + vn & d + un
    \end{pmatrix}.
  \]

\item[(4)]
  Therefore
  $\alpha \equiv a$, $\beta \equiv b$, $\gamma \equiv c$ and $\delta \equiv d \pmod{n}$
  and
  \begin{align*}
    \det
    \begin{pmatrix}
      \alpha & \beta \\
      \gamma & \delta
    \end{pmatrix}
    &=
    \det
    \begin{pmatrix}
      a & b + tn \\
      c + vn & d + un
    \end{pmatrix} \\
    &=
    a(d+un) - (b+tn)(c+vn) \\
    &=
    \underbrace{(ad - bc + sn)}_{= 1}
      + \underbrace{(au - (b+tn)v - s - ct)}_{= 0}n \\
    &= 1.
  \end{align*}
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 2.16.}
\addcontentsline{toc}{subsubsection}{Exercise 2.16.}
\emph{Let $f(n)$ denote the number of equivalence classes of matrices modulo $n$.
The $f$ is a multiplicative function.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Exercise 2.20.

\item[(2)]
  Exercise 2.15.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 2.17.}
\addcontentsline{toc}{subsubsection}{Exercise 2.17.}
\emph{If $a, b, n$ are integers with $n \geq 1$ and $\gcd(a,b,n) = 1$ the congruence
\[
  ax - by \equiv 1 \pmod{n}
\]
has exactly $n$ solutions, distinct congruent modulo $n$.
(A solution is an ordered pair $(x,y)$ of integers.)} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  No idea.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 2.18.}
\addcontentsline{toc}{subsubsection}{Exercise 2.18.}
\emph{For each prime $p$ the number of solutions,
distinct modulo $p^r$,
of all possible congruences of the form
\[
  ax - by \equiv 1 \pmod{p^r}, \text{ where } \gcd(a,b,p) = 1
\]
is equal to $f(p^r)$.} \\



\emph{Proof.}
  Note that $\gcd(a,b,p^r) = \gcd(a,b,p) = 1$.
  So the number of is exactly the same as $\abs{ SL_2(\mathbb{Z}/p^r\mathbb{Z}) } = f(p^r)$.
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 2.19.}
\addcontentsline{toc}{subsubsection}{Exercise 2.19.}
\emph{If $p$ is the number of pairs of integers $(a,b)$, incongruent modulo $p^r$,
which satisfy the condition $\gcd(a,b,p) = 1$ is $p^{2r-2}(p^2-1)$.} \\



\emph{Proof.}
  The number is
  \[
    \sum_{d|p^r} \mu(d)\left( \frac{p^r}{d} \right)^2
    = p^{2r} \sum_{d|p^r} \frac{\mu(d)}{d^2}
    = p^{2r} \left(1 - \frac{1}{p^2}\right)
    = p^{2r-2}(p^2 - 1)
  \]
  by the definition of the M\"obius function $\mu$.
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\subsubsection*{Exercise 2.20.}
\addcontentsline{toc}{subsubsection}{Exercise 2.20.}
\emph{$f(n) = n^3 \sum_{d|n} \frac{\mu(d)}{d^2}$, where $\mu$ is the M\"obius function.} \\



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  \begin{align*}
    f(n)
    &= \abs{ SL_2(\mathbb{Z}/n\mathbb{Z}) } \\
    &= n \abs{ \{ (a,b) \pmod{n} : \gcd(a,b,n) = 1 \} }
      &(\text{Exercise 2.17}) \\
    &= n \sum_{d|n} \mu(d)\left( \frac{n}{d} \right)^2
      &(\text{Inclusion-exclusion principle}) \\
    &= n^3 \sum_{d|n} \frac{\mu(d)}{d^2}.
  \end{align*}

\item[(2)]
  Since $n \mapsto \frac{1}{n^2}$ is multiplicative,
  Theorem 2.18 in the textbook: \emph{T. M. Apostol, Introduction to Analytic Number Theory}
  shows that
  \[
    \sum_{d|n} \frac{\mu(d)}{d^2} = \prod_{p|n} \left(1 - \frac{1}{p^2}\right).
  \]
  Hence we can also write
  \[
    f(n) = n^3 \sum_{d|n} \frac{\mu(d)}{d^2} = n^3 \prod_{p|n} \left(1 - \frac{1}{p^2}\right).
  \]

\item[(3)]
  In particular,
  $f$ is a multiplicative function (Exercise 2.16).
\end{enumerate}
$\Box$ \\



\emph{Note.}
  See ``\href{https://projecteuler.net/problem=193}{ProjectEuler 193: Squarefree Numbers}''
  for the same trick.
  The answer should be
  \[
    \sum_{d=1}^{\sqrt{n}} \mu(d) \left\lfloor \frac{n}{d^2} \right\rfloor.
  \] \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\end{document}