\documentclass{article}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{hyperref}
\usepackage[none]{hyphenat}
\usepackage{mathrsfs}
\usepackage{physics}
\parindent=0pt

\def\upint{\mathchoice%
    {\mkern13mu\overline{\vphantom{\intop}\mkern7mu}\mkern-20mu}%
    {\mkern7mu\overline{\vphantom{\intop}\mkern7mu}\mkern-14mu}%
    {\mkern7mu\overline{\vphantom{\intop}\mkern7mu}\mkern-14mu}%
    {\mkern7mu\overline{\vphantom{\intop}\mkern7mu}\mkern-14mu}%
  \int}
\def\lowint{\mkern3mu\underline{\vphantom{\intop}\mkern7mu}\mkern-10mu\int}

\begin{document}



\textbf{\Large Chapter 5: Differentiation} \\\\



\emph{Author: Meng-Gen Tsai} \\
\emph{Email: plover@gmail.com} \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.1.}
\emph{Let $f$ be defined for all real $x$, and suppose that
$$|f(x) - f(y)| \leq (x - y)^2$$
for all real $x$ and $y$. Prove that $f$ is a constant.} \\

\emph{Proof.}
\begin{enumerate}
\item[(1)]
Write
\[
  \left| \frac{f(x) - f(y)}{x - y} \right| \leq |x - y|
\]
if $x \neq y$.

\item[(2)]
Given any $y \in \mathbb{R}$,
\[
  \abs{ \frac{f(x) - f(y)}{x - y} } \to 0 \:\: \text{ as } \:\: x \to y,
\]
or $|f'(y)| = 0$.

\item[(3)]
Or using $\varepsilon$-$\delta$ argument. Fix $y \in \mathbb{R}$.
Given any $\varepsilon > 0$, there exists $\delta = \varepsilon > 0$ such that
$$\left| \frac{f(x) - f(y)}{x - y} - 0 \right| \leq |x - y| < \delta = \varepsilon$$
whenever $|x - y| < \delta$. That is, $|f'(y)| = 0$.

\item[(4)]
So $f'(y) = 0$ for any $y \in \mathbb{R}$.
By Theorem 5.11 (b), $f$ is a constant.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.2.}
\emph{Suppose $f'(x)>0$ in $(a,b)$.
Prove that $f$ is strictly increasing in $(a,b)$, and let $g$ be its inverse function.
Prove that $g$ is differentiable, and that
\[
  g'(f(x)) = \frac{1}{f'(x)} \:\:\:\:\:\:\:\: (a<x<b).
\]}

\emph{Proof.}
Let $E = (a,b)$.
\begin{enumerate}
\item[(1)]
Theorem 5.10 implies that
for any $a < p < q < b$ there exists $\xi \in (p,q)$ such that
\[
  f(p)-f(q) = (p-q)f'(\xi).
\]
Since $\xi \in (p,q) \subseteq E$, by assumption $f'(\xi) > 0$.
Hence $f(p)-f(q) = (p-q)f'(\xi) < 0$ (here $p-q < 0$), or
\[
  f(p) < f(q)
\]
if $p < q$.
Therefore, $f$ is strictly increasing in $(a,b)$.

\item[(2)]
\emph{Show that $f$ is one-to-one in $E$ if $f$ is strictly increasing in $E$.}
If $f(p) = f(q)$, then it cannot be $p > q$ or $p < q$ ((1)).
So that $p = q$, or $f$ is injective.

\item[(3)]
\emph{Show that $g$ is well-defined.}
Theorem 5.2 and Theorem 4.17.

\item[(4)]
\emph{Show that $ g'(f(x)) = \frac{1}{f'(x)}$.}
Given $y \in f(E)$, say $y = f(x)$ for some $x \in E$.
Given any $s \in f(E)$ with $s \neq y$.
Here $s = f(t)$ for some $t \in E$ and $t \neq x$.
\begin{align*}
  \lim_{s \to y} \frac{g(s) - g(y)}{s - y}
  &= \lim_{f(t) \to f(x)} \frac{g(f(t)) - g(f(x))}{f(t) - f(x)} \\
  &= \lim_{t \to x} \frac{t - x}{f(t) - f(x)} \\
  &= \lim_{t \to x} \frac{1}{\frac{f(t) - f(x)}{t - x}} \\
  &=\frac{1}{f'(x)}.
    &(f' > 0)
\end{align*}
Here $s \to y$ if and only if $t \to x$ since both $f$ and $g$
are continuous and one-to-one.
Hence $g$ is differentiable and $g'(f(x)) = \frac{1}{f'(x)}$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.3.}
\emph{Suppose $g$ is a real function on $\mathbb{R}^1$,
with bounded derivative (say $|g'|\leq M$).
Fix $\varepsilon > 0$, and define $f(x)=x+\varepsilon g(x)$.
Prove that $f$ is one-to-one if $\varepsilon$ is small enough.
(A set of admissible values of $\varepsilon$ can be determined which depends only on $M$.)} \\

\emph{Proof.}
\begin{enumerate}
\item[(1)]
Note that
$f'(x) = 1 + \varepsilon g'(x)$ (Theorem 5.3).
Since $|g'|\leq M$,
\[
  1 - \varepsilon M \leq f'(x) \leq 1 + \varepsilon M.
\]

\item[(2)]
Pick
\[
  \varepsilon = \frac{1}{M+1} > 0.
\]
Thus,
\[
  f'(x) \geq \frac{1}{M+1} > 0.
\]
By Exercise 5.2, $f(x)$ is strictly increasing in $\mathbb{R}$ or one-to-one in $\mathbb{R}$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.4.}
\emph{If
$$C_0 + \frac{C_1}{2} + \cdots + \frac{C_{n- 1}}{n} + \frac{C_n}{n + 1} = 0,$$
where $C_0, \ldots, C_n$ are real constants, prove that the equation
$$C_0 + C_1 x + \cdots + C_{n - 1} x^{n - 1} + C_n x^n = 0$$
has at least one real root between $0$ and $1$.} \\

\emph{Proof.}
Let
$$g(x) = C_0 x + \frac{C_1}{2} x^2 + \cdots + \frac{C_{n- 1}}{n} x^n + \frac{C_n}{n + 1} x^{n + 1}
\in \mathbb{R}[x].$$
Then $g(0) = g(1) = 0$, and
$g'(x) = C_0 + C_1 x + \cdots + C_{n - 1} x^{n - 1} + C_n x^n$.
By the mean value theorem (Theorem 5.10), there exists a point $\xi \in (0, 1)$ at which
$$g(1) - g(0) = g'(\xi)(1 - 0),$$
or $g'(\xi) = 0.$ That is, there exists a real root $x = \xi$ between $0$ and $1$
at which $C_0 + C_1 x + \cdots + C_{n - 1} x^{n - 1} + C_n x^n = 0$.
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.5.}
\emph{Suppose $f$ is defined and differentiable for every $x > 0$,
and $f'(x) \to 0$ as $x \to +\infty$.
Put $g(x) = f(x+1) - f(x)$.
Prove that $g(x) \to 0$ as $x \to +\infty$.} \\

\emph{Proof.}
Given any $x > 0$.
Since f is differentiable for every $x > 0$,
f is differentiable on $[x,x+1]$.
By Theorem 5.2 and Theorem 5.10 (the mean value theorem),
there is a point $\xi \in (x,x+1)$ at which
\[
  f(x+1) - f(x) = [(x+1) - x ]f'(\xi)
\]
or
\[
  g(x) = f'(\xi).
\]
As $x \to +\infty$, $\xi \to +\infty$.
Hence
\[
  \lim_{x \to +\infty} g(x)
  = \lim_{\xi \to +\infty} f'(\xi) = 0.
\]
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.6.}
\emph{Suppose}
\begin{enumerate}
  \item[(a)]
  \emph{$f$ is continuous for $x \geq 0$},

  \item[(b)]
  \emph{$f'(x)$ exists for $x > 0$},

  \item[(c)]
  \emph{$f(0) = 0$},

  \item[(d)]
  \emph{$f'$ is monotonically increasing.}
\end{enumerate}
\emph{Put
\[
  g(x) = \frac{f(x)}{x} \:\:\:\:\:\:\:\: (x>0)
\]
and prove that $g$ is monotonically increasing.} \\

\emph{Proof.}
\begin{enumerate}
  \item[(1)]
  It suffices to show that $g'(x) \geq 0$ for $x>0$ (Theorem 5.11(a)),
  that is, to show that
  \[
    g'(x) = \frac{x f'(x) - f(x)}{x^2} \geq 0 \:\:\:\:\:\:\:\: (x>0),
  \]
  or
  \[
    x f'(x) - f(x) \geq 0 \:\:\:\:\:\:\:\: (x>0)
  \]
  since $x^2 > 0$ for all nonzero $x$.

  \item[(2)]
  Given $x > 0$.
  By (a)(b), we apply the mean value theorem (Theorem 5.10) on $f$ to get
  \[
    f(x) - f(0) = (x - 0)f'(\xi)
  \]
  for some $\xi \in (0,x)$.
  By (c),
  \[
    f(x) = x f'(\xi).
  \]
  By (d),
  \[
    f(x) = x f'(\xi) \leq x f'(x).
  \]
  Hence $x f'(x) - f(x) \geq 0$,
  or $g$ is monotonically increasing.
\end{enumerate}
$\Box$ \\

\emph{Note.}
$g$ is increasing strictly if $f$ is increasing strictly. \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.7.}
\emph{Suppose $f'(x)$, $g'(x)$ exist, $g'(x) \neq 0$, and $f(x) = g(x) = 0$.
Prove that
\[
  \lim_{t \to x}{\frac{f(t)}{g(t)}} = \frac{f'(x)}{g'(x)}.
\]
(This holds also for complex functions.)} \\

\emph{Proof.}
\begin{align*}
  \frac{f'(t)}{g'(t)}
  &= \frac{\lim_{t \to x}{\frac{f(t)-f(x)}{t-x}}}{\lim_{t \to x}{\frac{g(t)-g(x)}{t-x}}} \\
  &= \lim_{t \to x} \frac{{\frac{f(t)-f(x)}{t-x}}}{{\frac{g(t)-g(x)}{t-x}}}
    &\text{(Both limits exist and $g' \neq 0$)} \\
  &= \lim_{t \to x} \frac{f(t)}{g(t)}.
    &\text{($f(x)=g(x)=0$)}
\end{align*}
This proof is also true for complex functions.
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.8.}
\emph{Suppose $f'(x)$ is continuous on $[a,b]$ and $\varepsilon > 0$.
Prove that there exists $\delta > 0$ such that
\[
  \abs{ \frac{f(t)-f(x)}{t-x} - f'(x) } < \varepsilon
\]
whenever $0 < |t-x| < \delta$, $a \leq x \leq b$, $a \leq t \leq b$.
(This could be expressed by saying $f$ is \textbf{uniformly differentiable}
on $[a,b]$ if $f'$ is continuous on $[a,b]$.)
Does this hold for vector-valued functions too?} \\

\emph{Proof.}
\begin{enumerate}
  \item[(1)]
  Since $f'(x)$ is continuous on a compact set $[a,b]$,
  $f'(x)$ is uniformly continuous on $[a,b]$.
  So given any $\varepsilon > 0$ there exists $\delta > 0$ such that
  \[
    | f'(t) - f'(x) | < \varepsilon
  \]
  whenever $0 < |t-x| < \delta$, $a \leq x \leq b$, $a \leq t \leq b$.

  \item[(2)]
  For such $t < x$ in (1),
  by the mean value theorem (Theorem 5.10),
  there exists a point $\xi \in (t,x)$
  at which
  \[
    f'(\xi) = \frac{f(t)-f(x)}{t-x}.
  \]
  Note that $\xi$ is also satisfying $0 < |t-\xi| < |t-x| < \delta$
  and $a \leq \xi \leq b$.
  Hence by (1) we also have
  \[
    | f'(\xi) - f'(x) | < \varepsilon,
  \]
  or
  \[
    \abs{ \frac{f(t)-f(x)}{t-x} - f'(x) } < \varepsilon.
  \]

  \item[(3)]
  \emph{Suppose $\mathbf{f}'(x)$ is continuous on $[a,b]$ and $\varepsilon > 0$.
  Prove that there exists $\delta > 0$ such that
  \[
    \abs{ \frac{\mathbf{f}(t)-\mathbf{f}(x)}{t-x} - \mathbf{f}'(x) } < \varepsilon
  \]
  whenever $0 < |t-x| < \delta$, $a \leq x \leq b$, $a \leq t \leq b$.}
  \begin{enumerate}
  \item[(a)]
  Write
  \[
    \mathbf{f}(x) = (f_1(x), \ldots, f_k(x)) \in \mathbb{R}^k.
  \]
  By Remarks 5.16,
  $\mathbf{f}(x)$ is differentiable at a point $x$ if and only if
  each $f_1, \ldots, f_k$ is differentiable at $x$.
  So that
  \[
    \mathbf{f}'(x) = (f_1'(x), \ldots, f_k'(x)) \in \mathbb{R}^k.
  \]
  By Theorem 4.10,
  $\mathbf{f}'(x)$ is continuous if and only if
  each $f_1, \ldots, f_k$ is continuous.

  \item[(b)]
  Similar to (1)(2),
  Since $f_i'(x)$ is continuous on a compact set $[a,b]$ where $1 \leq i \leq k$,
  $f_i'(x)$ is uniformly continuous on $[a,b]$.
  So given any $\varepsilon > 0$ there exists $\delta_i > 0$ such that
  \[
    | f_i'(t) - f_i'(x) | < \frac{\varepsilon}{\sqrt{k}}
  \]
  whenever $0 < |t-x| < \delta_i$, $a \leq x \leq b$, $a \leq t \leq b$.
  Take $\delta = \min_{1 \leq i \leq k} \delta_i > 0$.

  \item[(c)]
  For such $t < x$ in (1),
  by the mean value theorem (Theorem 5.10),
  there exists a point $\xi_i \in (t,x)$
  at which
  \[
    f_i'(\xi_i) = \frac{f_i(t)-f_i(x)}{t-x}.
  \]
  Note that $\xi_i$ is also satisfying $0 < |t-\xi_i| < |t-x| < \delta$
  and $a \leq \xi_i \leq b$.
  Hence by (1) we also have
  \[
    | f_i'(\xi_i) - f_i'(x) | < \frac{\varepsilon}{\sqrt{k}},
  \]
  or
  \[
    \abs{ \frac{f_i(t)-f_i(x)}{t-x} - f_i'(x) } < \frac{\varepsilon}{\sqrt{k}}.
  \]

  \item[(d)]
  Hence
  \[
    \abs{ \frac{\mathbf{f}(t)-\mathbf{f}(x)}{t-x} - \mathbf{f}'(x) }
    = \left( \sum_{i=1}^{k} \abs{ \frac{f_i(t)-f_i(x)}{t-x} - f_i'(x) }^2 \right)^{\frac{1}{2}}
    < \varepsilon.
  \]
  \end{enumerate}
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.9.}
\emph{Let $f$ be a continuous real function on $\mathbb{R}^1$,
of which it is known that $f'(x)$ exists for all $x \neq 0$ and that $f'(x) \to 3$ as $x \to 0$.
Dose it follow that $f'(0)$ exists?} \\

\emph{Proof.}
\begin{enumerate}
  \item[(1)]
  \emph{Show that $f'(0) = 3$.}
  It is equivalent to show that
  \[
    \lim_{x \to 0} \frac{f(x) - f(0)}{x - 0} = 3.
  \]
  Write $F(x) = f(x) - f(0)$ and $G(x) = x - 0$ on $\mathbb{R}^1$.
  So that
  \[
    \lim_{x \to 0} \frac{f(x) - f(0)}{x - 0} = \lim_{x \to 0} \frac{F(x)}{G(x)} = 0.
  \]

  \item[(2)]
  Note that
    \[
      \lim_{x \to 0} \frac{F'(x)}{G'(x)}
      = \lim_{x \to 0} \frac{f'(x)}{1}
      = 3.
    \]

  \item[(3)]
  Since $f$ is continuous on $\mathbb{R}^1$,
  $F$ is continuous on $\mathbb{R}^1$.
  Hence
    \[
      \lim_{x \to 0} F(x) = F(\lim_{x \to 0} x) = F(0) = 0.
    \]
  Also, $G$ is continuous on $\mathbb{R}^1$ implies that
    \[
      \lim_{x \to 0} G(x) = G(\lim_{x \to 0} x) = G(0) = 0.
    \]

  \item[(4)]
  Apply L'Hospital's rule (Theorem 5.13) to (2)(3), we have
  \[
    \lim_{x \to 0} \frac{F(x)}{G(x)} = 3,
  \]
  or $f'(0) = 3$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.10.}
\emph{Suppose $f$ and $g$ are complex differentiable functions on $(0,1)$,
$f(x) \to 0$, $g(x) \to 0$, $f'(x) \to A$, $g'(x) \to B$ as $x \to 0$,
where $A$ and $B$ are complex numbers, $B \neq 0$.
Prove that
\[
  \lim_{x \to 0}{\frac{f(x)}{g(x)}}= \frac{A}{B}.
\]
Compare with Example 5.18.
(Hint:
\[
  \frac{f(x)}{g(x)}
  = \left( \frac{f(x)}{x} - A \right) \frac{x}{g(x)} +  A\frac{x}{g(x)}.
\]
Apply Theorem 5.13 to
the real and imaginary parts of $\frac{f(x)}{x}$ and $\frac{g(x)}{x}$.)} \\

\emph{Proof (Hint).}
\begin{enumerate}
  \item[(1)]
  Write
  \[
    f(x) = f_1(x) + i f_2(x)
  \]
  for $x \in (0,1)$,
  where both $f_1$ and  $f_2$ are real functions.
  By Remarks 5.16, it is clear that
  \[
    f'(x) = f_1'(x) + i f_2'(x).
  \]

  \item[(2)]
  Write
  \[
    A = A_1 + i A_2
  \]
  where both $A_1$ and $A_2$ are real numbers.
  Then as $x \to 0$, we have
  \begin{enumerate}
    \item[(a)]
    $f(x) \to 0$ if and only if $f_1(x) \to 0$ and $f_2(x) \to 0$.

    \item[(b)]
    $f'(x) \to A$ if and only if $f_1'(x) \to A_1$ and $f_2'(x) \to A_2$.
  \end{enumerate}

  Hence by L'Hospital's rule (Theorem 5.13),
  \[
    \lim_{x \to 0} \frac{f_i(x)}{x}
    = \lim_{x \to 0} \frac{f_i'(x)}{1} = A_i
  \]
  ($i = 1, 2$) or
  \begin{align*}
    \lim_{x \to 0} \frac{f(x)}{x}
    &= \lim_{x \to 0} \frac{f_1(x) + i f_2(x)}{x} \\
    &= \lim_{x \to 0} \frac{f_1(x)}{x} + i \lim_{x \to 0} \frac{f_2(x)}{x} \\
    &= A_1 + i A_2 \\
    &= A.
  \end{align*}
  Similarly,
  \[
    \lim_{x \to 0} \frac{g(x)}{x} = B.
  \]
  Note that $B \neq 0$, and thus
  \[
    \lim_{x \to 0} \frac{x}{g(x)} = \frac{1}{B}.
  \]

  \item[(3)]
  Hence
  \begin{align*}
    \lim_{x \to 0} \frac{f(x)}{g(x)}
    &= \lim_{x \to 0}
      \left[ \left( \frac{f(x)}{x} - A \right) \frac{x}{g(x)} + A\frac{x}{g(x)} \right] \\
    &= \lim_{x \to 0} \left( \frac{f(x)}{x} - A \right) \cdot \lim_{x \to 0} \frac{x}{g(x)}
      + \lim_{x \to 0} A\frac{x}{g(x)} \\
    &= 0 \cdot \frac{1}{B} + \frac{A}{B} \\
    &= \frac{A}{B}.
  \end{align*}

  \item[(4)]
  \emph{Compare with Example 5.18.}
  Define $f(x) = x$ and $g(x) = x + x^2 \exp(\frac{i}{x^2})$ as in Example 5.18.
  Note that $f(x) \to 0$, $g(x) \to 0$, $f'(x) \to 1$ and $g'(x) \to \infty$ as $x \to 0$.
  By Example 5.18
  \[
    \lim_{x \to 0} \frac{f(x)}{g(x)} = 1
    \neq 0 = \frac{1}{\infty} = \lim_{x \to 0} \frac{A}{B}.
  \]
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.11.}
\emph{Suppose $f$ is defined in a neighborhood of $x$, and suppose $f''(x)$ exists.
Show that
\[
  \lim_{h \to 0}{\frac{f(x+h) + f(x-h) - 2f(x)}{h^2}} = f''(x).
\]
Show by an example that the limit may exist even if $f''(x)$ dose not.
(Hint: Use Theorem 5.13.)} \\

\emph{Proof (Theorem 5.13).}
\begin{enumerate}
  \item[(1)]
  Write $F(h) = f(x+h) + f(x-h) - 2f(x)$ and $G(h) = h^2$.
  It is equivalent to show that
  \[
    \lim_{h \to 0}\frac{F(h)}{G(h)} = f''(x).
  \]
  We might apply Theorem 5.13 (L'Hospital rule) to get it.

  \item[(2)]
  \emph{Show that $\lim_{h \to 0} F(h) = 0$ and $\lim_{h \to 0} G(h) = 0$.}
  It is clear that $\lim_{h \to 0} G(h) = \lim_{h \to 0} h^2 = 0$
  since $x \mapsto x^2$ is continuous on $\mathbb{R}^1$.
  Besides, since $f$ is continuous at $x$ (by applying Theorem 5.2 twice),
  \[
    \lim_{h \to 0} F(h)
    = f(x) + f(x) - 2f(x)
    = 0.
  \]

  \item[(3)]
  \emph{Show that
  \[
    \lim_{h \to 0} \frac{F'(h)}{G'(h)} = \lim_{h \to 0} \frac{f'(x+h) - f'(x-h)}{2h}
  \]
  is well-defined.}
  Since $f''(x)$ exists in a neighborhood $B(x;r)$ of $x$ (where $r > 0$),
  $f'(x)$ exists and is continuous in $B(x;r)$ (Theorem 5.2).
  As $0 < |h| < \frac{r}{2}$,
  \[
    x+h \in B\left(x+h;\frac{r}{2}\right) \subseteq B(x;r)
  \]
  and
  \[
    x-h \in B\left(x-h;\frac{r}{2}\right) \subseteq B(x;r).
  \]
  So $f'(x+h)$ and $f'(x-h)$ exist in $B(x;r)$ as $0 < |h| < \frac{r}{2}$.
  Hence
  \[
    \lim_{h \to 0} \frac{F'(h)}{G'(h)}
    = \lim_{h \to 0} \frac{f'(x+h) - f'(x-h)}{2h}
  \]
  is well-defined (Theorem 5.3 and Theorem 5.5 (the chain rule)).

  \item[(4)]
  \emph{Show that
  \[
    \lim_{h \to 0} \frac{f'(x+h) - f'(x-h)}{2h} = f''(x).
  \]}

  Since $f''(x)$ exists, by definition
  \[
    \lim_{h \to 0} \frac{f'(x+h) - f'(x)}{h} = f''(x)
  \]
  and
  \[
    \lim_{h \to 0} \frac{f'(x-h) - f'(x)}{-h} = f''(x).
  \]
  Sum up two expressions to get
  \[
    2 f''(x) = \lim_{h \to 0} \frac{f'(x-h) - f'(x-h)}{h}.
  \]

  \item[(5)]
  By (2)(3)(4) and Theorem 5.13 (L'Hospital rule),
  the result is established.

  \item[(6)]
  \emph{Given $f(x) = x|x|$ on $\mathbb{R}^1$.
  Show that
  \[
    \lim_{h \to 0}{\frac{f(h) + f(-h) - 2f(0)}{h^2}} = 0
  \]
  but $f''(x)$ does not exist at $x = 0$.}
  Clearly,
  \begin{align*}
    \lim_{h \to 0}{\frac{f(h) + f(-h) - 2f(0)}{h^2}}
    &= \lim_{h \to 0}{\frac{h|h| + (-h)|-h| - 2 \cdot 0}{h^2}} \\
    &= \lim_{h \to 0}{\frac{h|h| - h|h| - 0}{h^2}} \\
    &= \lim_{h \to 0}{0} \\
    &= 0.
  \end{align*}
  But $f''(x)$ does not exist by Exercise 5.12.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.12.}
\emph{If $f(x) = |x|^3$, compute $f'(x)$, $f''(x)$ for all real $x$,
and show that $f^{(3)} (0)$ does not exist.} \\

\emph{Proof.}
\begin{enumerate}
  \item[(1)]
  Write
  \begin{equation*}
    f(x) =
    \begin{cases}
      x^3 & (x \geq 0), \\
      -x^3 & (x \leq 0).
    \end{cases}
  \end{equation*}

  \item[(2)]
  \emph{Show that $f'(x) = 3x|x|$.}
  It is trivial that
  \begin{equation*}
    f'(x) =
    \begin{cases}
      3x^2 & (x > 0), \\
      -3x^2 & (x < 0).
    \end{cases}
  \end{equation*}
  Note that
  \[
    \lim_{x \to 0} f'(x) = 0.
  \]
  Apply the same argument in Exercise 5.9, we have
  \[
    f'(0) = 0.
  \]
  Hence $f'$ exists and $f'(x) = 3x|x|$ for any $x \in \mathbb{R}$.

  \item[(3)]
  \emph{Show that $f''(x) = 6|x|$.}
  Similar to (2).
  \begin{equation*}
    f''(x) =
    \begin{cases}
      6x & (x > 0), \\
      -6x & (x < 0).
    \end{cases}
  \end{equation*}
  Note that
  \[
    \lim_{x \to 0} f''(x) = 0.
  \]
  Apply the same argument in Exercise 5.9, we have
  \[
    f''(0) = 0.
  \]
  Hence $f''$ exists and $f''(x) = 6|x|$ for any $x \in \mathbb{R}$.

  \item[(4)]
  \emph{Show that $f^{(3)} (0)$ does not exist.}
  \begin{equation*}
    f'''(x) =
    \begin{cases}
      6 & (x > 0), \\
      -6 & (x < 0).
    \end{cases}
  \end{equation*}

  There are some proofs for showing that $f^{(3)} (0)$ does not exist.
  \begin{enumerate}
  \item[(a)]
  Since
  \[
    \lim_{t \to 0+} \frac{f''(t) - f''(0)}{t - 0}
    = \lim_{t \to 0+} \frac{6t}{t} = 6
  \]
  and
  \[
    \lim_{t \to 0-} \frac{f''(t) - f''(0)}{t - 0}
    = \lim_{t \to 0-} \frac{-6t}{t} = -6,
  \]
  $f^{(3)} (0)$ does not exist.

  \item[(b)]
  (Reductio ad absurdum)
  If $f$ were differentiable on $\mathbb{R}^1$,
  then
  \[
    \lim_{t \to 0+} f'''(t) = 6
  \]
  and
  \[
    \lim_{t \to 0-} f'''(t) = -6,
  \]
  or $f'''$ has a simple discontinuity at $x = 0$,
  contrary to Corollary to Theorem 5.12.
  \end{enumerate}
\end{enumerate}
$\Box$ \\

\emph{Note.}
Given $k > 0$.
We can construct one real function $f$ on $\mathbb{R}^1$, say
  \begin{equation*}
    f(x) =
    \begin{cases}
      |x|^k      & (\text{$k$ is odd}), \\
      x|x|^{k-1} & (\text{$k > 0$ is even}),
    \end{cases}
  \end{equation*}
such that
all $f^{(0)}(0) = \cdots = f^{(k-1)}(0) = 0$ exist but $f^{(k)}(0)$ does not exist.
\\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.13.}
\emph{Suppose $a$ and $c$ are real numbers, $c > 0$,
and $f$ is defined on $[-1,1]$ by
  \begin{equation*}
  f(x) =
    \begin{cases}
      x^a \sin{(x^{-c})} & (\text{if } x \neq 0), \\
      0                  & (\text{if } x = 0).
    \end{cases}
  \end{equation*}
Prove the following statements:}
\begin{enumerate}
  \item[(a)]
  \emph{$f$ is continuous if and only if $a > 0$.}

  \item[(b)]
  \emph{$f'(0)$ exists if and only if $a > 1$.}

  \item[(c)]
  \emph{$f'$ is bounded if and only if $a \geq 1+c$.}

  \item[(d)]
  \emph{$f'$ is continuous if and only if $a > 1+c$.}

  \item[(e)]
  \emph{$f''(0)$ exists if and only if $a > 2 + c$.}

  \item[(f)]
  \emph{$f''$ is bounded if and only if $a \geq 2+2c$.}

  \item[(g)]
  \emph{$f''$ is continuous if and only if $a > 2+2c$.} \\
\end{enumerate}

Note that $f$ is not well-defined as a real function if $x < 0$.
Hence we modify the definition of $f$ for the case $x < 0$:
  \begin{equation*}
  f(x) =
    \begin{cases}
      |x|^a \sin{(|x|^{-c})} & (\text{if } x \neq 0), \\
      0                      & (\text{if } x = 0). \\
    \end{cases}
  \end{equation*}

\emph{Proof of (a).}
\begin{enumerate}
  \item[(1)]
  Since $|x|^a \sin{(|x|^{-c})}$ is continuous on $\mathbb{R}^1 - \{0\}$,
  $f$ is continuous if and only if
  \[
    \lim_{x \to 0} |x|^a \sin{(|x|^{-c})} = 0.
  \]

  \item[(2)]
  \emph{Given $a > 0$.
  Show that}
  \[
    \lim_{x \to 0} |x|^a \sin{(|x|^{-c})} = 0.
  \]
  Since $|x|^a \to 0$ as $x \to 0$ and $\abs{ \sin{(|x|^{-c})} }$ is bounded by $1$,
  the limit $\lim |x|^a \sin{(|x|^{-c})}$ exists and is equal to $0$.

  \item[(3)]
  \emph{Given $a = 0$.
  Show that
  \[
    \lim_{x \to 0} |x|^a \sin{(|x|^{-c})} = \lim_{x \to 0} \sin{(|x|^{-c})}
  \]
  does not exist although
  $|x|^a \sin{(|x|^{-c})} = \sin{(|x|^{-c})}$ is bounded on $[-1,1] - \{0\}$.}
  \begin{enumerate}
    \item[(a)]
    Take $x_n = \left( \frac{\pi}{2} + 2n\pi \right)^{-\frac{1}{c}} \neq 0$
    for $n = 1, 2, 3, \ldots$.
    The sequence $\{ x_n \}$ converges to $0$, and
    \[
      \lim_{n \to \infty} f(x_n)
      = \lim_{n \to \infty} \sin{(|x_n|^{-c})}
      = \lim_{n \to \infty} 1
      = 1.
    \]

    \item[(b)]
    Similarly, take $y_n = \left( 2n\pi \right)^{-\frac{1}{c}} \neq 0$
    for $n = 1, 2, 3, \ldots$.
    The sequence $\{ y_n \}$ converges to $0$, and
    \[
      \lim_{n \to \infty} f(y_n) = 0.
    \]

    \item[(c)]
    By (a)(b), $\lim_{x \to 0} |x|^a \sin{(|x|^{-c})}$ does not exist (Theorem 4.2).

    \item[(d)]
    Clearly, $|\sin{(|x|^{-c})}| \leq 1$ as $\sin{(|x|^{-c})}$ is well-defined.
  \end{enumerate}

  \item[(4)]
  \emph{Given $a < 0$.
  Show that
  \[
    \lim_{x \to 0} |x|^a \sin{(|x|^{-c})}
  \]
  does not exist.}
  Similar to (3), we take the same $\{x_n\}$ and $\{y_n\}$ as (3)
  to get the similar result:
  \begin{align*}
    \lim_{n \to \infty} f(x_n) &= \infty, \\
    \lim_{n \to \infty} f(y_n) &= 0.
  \end{align*}
  By Theorem 4.2, $\lim_{x \to 0} |x|^a \sin{(|x|^{-c})}$ does not exist.

  \item[(5)]
  By (2)(3)(4), $f$ is continuous if and only if $a > 0$.
\end{enumerate}
$\Box$ \\



\emph{Proof of (b).}
\begin{enumerate}
  \item[(1)]
  By definition,
  \[
    f'(0)
    = \lim_{x \to 0} \frac{f(x) - f(0)}{x - 0}
    = \lim_{x \to 0} \mathrm{sgn}(x) |x|^{a-1} \sin{(|x|^{-c})}.
  \]
  Here $\mathrm{sgn}(x)$ is the sign function defined by
  \begin{equation*}
  \mathrm{sgn}(x) =
    \begin{cases}
      1 & (x > 0), \\
      0 & (x = 0), \\
      -1 & (x < 0).
    \end{cases}
  \end{equation*}

  \item[(2)]
  Similar to (2)(3)(4) in the proof of (a),
  $f'(0) = 0$ exists if and only if $a - 1 > 0$.
\end{enumerate}
$\Box$ \\



\emph{Proof of (c).}
\begin{enumerate}
  \item[(1)]
  Write $E = [-1,1] - \{0\}$.
  $f'$ is bounded if and only if $f'(0)$ exists and $f'$ is bounded on $E$.

  \item[(2)]
  Given any $x \in E$,
  \begin{align*}
    f'(x)
    &= \mathrm{sgn}(x)\left( a|x|^{a-1} \sin(|x|^{-c}) + |x|^a \cos(|x|^{-c})(-c)|x|^{-c-1} \right) \\
    &= \mathrm{sgn}(x)|x|^{a-c-1} \left( a|x|^{c}\sin(|x|^{-c}) - c\cos(|x|^{-c}) \right).
  \end{align*}

  \item[(3)]
  \emph{Given $a-c-1 \geq 0$.
  Show that $f'$ is bounded on $E$.}
  Since $\mathrm{sgn}(x)$ is bounded by $1$ on $E$,
  $|x|^{a-c-1}$ is bounded by $1$ on $E$ and
  $a|x|^{c}\sin(|x|^{-c}) - c\cos(|x|^{-c})$ is bounded by $|a|+|c|$ on $E$,
  $f'$ is bounded on $E$.

  \item[(4)]
  \emph{Given $a-c-1 < 0$.
  Show that $f'$ is unbounded on $E$.}
  Take $x_n = \left( 2n\pi \right)^{-\frac{1}{c}} \neq 0$
  for $n = 1, 2, 3, \ldots$.
  The sequence $\{ x_n \}$ converges to $0$, and
  \[
    \lim_{n \to \infty} f'(x_n)
    = \lim_{n \to \infty} -c (2n\pi)^{-\frac{a-c-1}{c}}
    = -\infty.
  \]

  \item[(5)]
  By (b), $f'(0)$ exists if and only if $a > 1$.
  By (3)(4), $f'$ is bounded on $E$ if and only if $a-c-1 \geq 0$.
  Since $c > 0$, $f'$ is bounded on $[-1,1]$ if and only if $a-c-1 \geq 0$.
\end{enumerate}
$\Box$ \\



\emph{Proof of (d).}
Similar to the proof of (a).
\begin{enumerate}
  \item[(1)]
  Write $E = [-1,1] - \{0\}$.
  By (b)(c),
  \begin{equation*}
  f'(x) =
    \begin{cases}
      0
        & \text{ if } x = 0, \\
      \mathrm{sgn}(x)|x|^{a-c-1} \left( a|x|^{c}\sin(|x|^{-c}) - c\cos(|x|^{-c}) \right)
        & \text{ if } x \in E.
    \end{cases}
  \end{equation*}
  Clearly, $f'$ is continuous on $E$.
  Hence, $f'$ is continuous if and only if $\lim_{x \to 0} f'(x) = f'(0) = 0$.

  \item[(2)]
  \emph{Given $a-c-1 > 0$.
  Show that $\lim_{x \to 0} f'(x) = 0$.}
  Since $|x|^{a-c-1} \to 0$ as $x \to 0$,
  $\mathrm{sgn}(x)$ is bounded by $1$ on $E$, and
  $a|x|^{c}\sin(|x|^{-c}) - c\cos(|x|^{-c})$ is bounded by $|a|+|c|$ on $E$,
  \[
    \mathrm{sgn}(x) |x|^{a-c-1} \left( a|x|^{c}\sin(|x|^{-c}) - c\cos(|x|^{-c}) \right) \to 0
  \]
  as $x \to 0$.
  The result is established.

  \item[(3)]
  \emph{Given $a-c-1 = 0$.
  Show that $\lim_{x \to 0} f'(x)$ does not exist.}
  \begin{enumerate}
    \item[(a)]
    Take $x_n = \left( \frac{\pi}{2} + 2n\pi \right)^{-\frac{1}{c}} \neq 0$
    for $n = 1, 2, 3, \ldots$.
    The sequence $\{ x_n \}$ converges to $0$, and
    \begin{align*}
      \lim_{n \to \infty} f'(x_n)
      &= \lim_{n \to \infty} \mathrm{sgn}(x_n)
        \left( a|x_n|^{c}\sin(|x_n|^{-c}) - c\cos(|x_n|^{-c}) \right) \\
      &= \lim_{n \to \infty} \frac{a}{\frac{\pi}{2} + 2n\pi} \\
      &= 0.
    \end{align*}

    \item[(b)]
    Similarly, take $y_n = \left( 2n\pi \right)^{-\frac{1}{c}} \neq 0$
    for $n = 1, 2, 3, \ldots$.
    The sequence $\{ y_n \}$ converges to $0$, and
    \begin{align*}
      \lim_{n \to \infty} f'(y_n)
      &= \lim_{n \to \infty} \mathrm{sgn}(y_n)
        \left( a|y_n|^{c}\sin(|y_n|^{-c}) - c\cos(|y_n|^{-c}) \right) \\
      &= \lim_{n \to \infty} -c \\
      &= -c \neq 0.
    \end{align*}

    \item[(c)]
    By (a)(b), $\lim_{x \to 0} f'(x)$
    does not exist (Theorem 4.2).
  \end{enumerate}

  \item[(4)]
  \emph{Given $a-c-1 < 0$.
  Show that $\lim_{x \to 0} f'(x)$ does not exist.}
  It is the same as (4) in the proof of (c).

  \item[(5)]
  By (2)(3)(4),
  $f'$ is continuous if and only if
  $\lim_{x \to 0} f'(x) = 0$ if and only if
  $a-c-1 > 0$.
\end{enumerate}
$\Box$ \\



\emph{Proof of (e).}
Similar to the proof of (b).
\begin{enumerate}
  \item[(1)]
  Write $E = [-1,1] - \{0\}$.
  By the proof of (d),
  \begin{equation*}
  f'(x) =
    \begin{cases}
      0
        & \text{ if } x = 0, \\
      \mathrm{sgn}(x) |x|^{a-c-1} \left( a|x|^{c}\sin(|x|^{-c}) - c\cos(|x|^{-c}) \right)
        & \text{ if } x \in E.
    \end{cases}
  \end{equation*}
  By definition
  \begin{align*}
    f''(0)
    &= \lim_{x \to 0} \frac{f'(x) - f'(0)}{x - 0} \\
    &= \lim_{x \to 0} |x|^{a-c-2} \left( a|x|^{c}\sin(|x|^{-c}) - c\cos(|x|^{-c}) \right).
  \end{align*}
  (Here $\mathrm{sgn}(x)^2 = 1$ if $x \neq 0$.)

  \item[(2)]
  Similar to (2)(3)(4) in the proof of (d),
  $f''(0) = 0$ exists if and only if $(a-c-1) - 1 = a-c-2 > 0$.
\end{enumerate}
$\Box$ \\



\emph{Proof of (f).}
Similar to the proof of (c).
\begin{enumerate}
  \item[(1)]
  Write $E = [-1,1] - \{0\}$.
  $f''$ is bounded if and only if $f''(0)$ exists and $f''$ is bounded on $E$.

  \item[(2)]
  Given any $x \in E$,
  \begin{align*}
    f''(x)
    =& |x|^{a-2c-2} \\
      &\cdot \left[
        ( a(a-1)|x|^{2c} - c^2 ) \sin(|x|^{-c})
        - c(2a-c-1)|x|^c\cos(|x|^{-c})
      \right].
  \end{align*}

  \item[(3)]
  \emph{Given $a-2c-2 \geq 0$.
  Show that $f''$ is bounded on $E$.}
  Since $|x|^{a-2c-2}$ is bounded by $1$ on $E$ and
  \begin{align*}
    &\abs{( a(a-1)|x|^{2c} - c^2 ) \sin(|x|^{-c}) - c(2a-c-1)|x|^c\cos(|x|^{-c})} \\
    \leq&
    |a(a-1)| + |c^2| + |c(2a-c-1)|
  \end{align*}
  is bounded on $E$, $f''$ is bounded on $E$.

  \item[(4)]
  \emph{Given $a-2c-2 < 0$.
  Show that $f''$ is unbounded on $E$.}
  Take
  $x_n = \left( \frac{\pi}{2} + 2n\pi \right)^{-\frac{1}{c}} \neq 0$
  for $n = 1, 2, 3, \ldots$.
  The sequence $\{ x_n \}$ converges to $0$, and
  \begin{align*}
    &\lim_{n \to \infty} f''(x_n) \\
    =& \lim_{n \to \infty}
      \underbrace{\left( a(a-1)
        \left( \frac{\pi}{2} + 2n\pi \right)^{-2} - c^2 \right)}_{\to -c^2 \neq 0}
      \underbrace{\left( \frac{\pi}{2} + 2n\pi \right)^{-\frac{a-2c-2}{c}}}_{\to \infty} \\
    =& - \infty.
  \end{align*}

  \item[(5)]
  By (e), $f''(0)$ exists if and only if $a - c - 2 > 0$.
  By (3)(4), $f''$ is bounded on $E$ if and only if $a - 2c - 2 \geq 0$.
  Since $c > 0$, $f''$ is bounded on $[-1,1]$ if and only if $a-2c-2 \geq 0$.
\end{enumerate}
$\Box$ \\



\emph{Proof of (g).}
Similar to the proof of (a) or (d).
\begin{enumerate}
  \item[(1)]
  Write $E = [-1,1] - \{0\}$.
  By (e)(f),
  \begin{equation*}
  f''(x) =
    \begin{cases}
      0
        & \text{ if } x = 0, \\
      |x|^{a-2c-2} \left[
        ( a(a-1)|x|^{2c} - c^2 ) \sin(|x|^{-c}) - c(2a-c-1)|x|^c\cos(|x|^{-c})
      \right].
        & \text{ if } x \in E. \\
    \end{cases}
  \end{equation*}
  Clearly, $f''$ is continuous on $E$.
  Hence, $f''$ is continuous if and only if $\lim_{x \to 0} f''(x) = f''(0) = 0$.

  \item[(2)]
  \emph{Given $a-2c-2 > 0$.
  Show that $\lim_{x \to 0} f''(x) = 0$.}
  Since $|x|^{a-2c-2} \to 0$ as $x \to 0$ and
  \[
    ( a(a-1)|x|^{2c} - c^2 ) \sin(|x|^{-c}) - c(2a-c-1)|x|^c\cos(|x|^{-c})
  \]
  is bounded by $|a(a-1)| + |c^2| + |c(2a-c-1)|$ on $E$,
  \begin{align*}
    &|x|^{a-2c-2} \\
    &\cdot \left[
      ( a(a-1)|x|^{2c} - c^2 ) \sin(|x|^{-c}) - c(2a-c-1)|x|^c\cos(|x|^{-c})
    \right] \to 0
  \end{align*}
  as $x \to 0$.
  The result is established.

  \item[(3)]
  \emph{Given $a-2c-2 = 0$.
  Show that $\lim_{x \to 0} f''(x)$ does not exist.}
  \begin{enumerate}
    \item[(a)]
    Take $x_n = \left( \frac{\pi}{2} + 2n\pi \right)^{-\frac{1}{c}} \neq 0$
    for $n = 1, 2, 3, \ldots$.
    The sequence $\{ x_n \}$ converges to $0$, and
    \begin{align*}
      &\lim_{n \to \infty} f''(x_n) \\
      =& \lim_{n \to \infty}
        ( a(a-1)|x_n|^{2c} - c^2 ) \sin(|x_n|^{-c}) - c(2a-c-1)|x_n|^c\cos(|x_n|^{-c}) \\
      =& \lim_{n \to \infty} \frac{a(a-1)}{\left( \frac{\pi}{2} + 2n\pi \right)^2} - c^2 \\
      =& -c^2
    \end{align*}

    \item[(b)]
    Similarly, take $y_n = \left( \frac{3\pi}{2} + 2n\pi \right)^{-\frac{1}{c}} \neq 0$
    for $n = 1, 2, 3, \ldots$.
    The sequence $\{ y_n \}$ converges to $0$, and
    \begin{align*}
      &\lim_{n \to \infty} f''(y_n) \\
      =& \lim_{n \to \infty}
        ( a(a-1)|y_n|^{2c} - c^2 ) \sin(|y_n|^{-c}) - c(2a-c-1)|y_n|^c\cos(|y_n|^{-c}) \\
      =& \lim_{n \to \infty} -\frac{a(a-1)}{\left( \frac{3\pi}{2} + 2n\pi \right)^2} + c^2 \\
      =& c^2.
    \end{align*}

    \item[(c)]
    By (a)(b), $\lim_{x \to 0} f''(x)$
    does not exist (Theorem 4.2).
  \end{enumerate}

  \item[(4)]
  \emph{Given $a-2c-2 < 0$.
  Show that $\lim_{x \to 0} f''(x)$ does not exist.}
  It is the same as (4) in the proof of (f).

  \item[(5)]
  By (2)(3)(4),
  $f''$ is continuous if and only if
  $\lim_{x \to 0} f''(x) = 0$ if and only if
  $a-2c-2 > 0$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.14.}
\emph{Let $f$ be a differentiable real function defined in $(a,b)$.
Prove that $f$ is convex if and only if $f'$ is monotonically increasing.
Assume next $f''(x)$ exists for every $x \in (a,b)$,
and prove that $f$ is convex if and only if $f''(x) \geq 0$ for all $x \in (a,b)$.} \\

\emph{Proof.}
\begin{enumerate}
\item[(1)]
  \emph{Show that $f'$ is monotonically increasing if $f$ is convex.}
  \begin{enumerate}
  \item[(a)]
  Since $f$ is convex, by definition (Exercise 4.23)
  \[
    f(\lambda x + (1-\lambda) y) \leq \lambda f(x) + (1-\lambda) f(y)
  \]
  whenever $a < x < b$, $a < y < b$, $0 < \lambda < 1$.

  \item[(b)]
  As $x \neq y$, we have
  \begin{align*}
    f(y) - f(x)
    &\geq \frac{f(x + \lambda(y-x)) - f(x)}{\lambda} \\
    &= \frac{f(x + \lambda(y-x)) - f(x)}{\lambda(y-x)} \cdot (y-x)
  \end{align*}
  and let $\lambda \to 0$ to get
  \[
    f(y) - f(x) \geq f'(x)(y - x)
  \]
  (since $f'(x)$ exists).
  Similarly, we have
  \[
    f(x) - f(y) \geq f'(y)(x - y).
  \]

  \item[(c)]
  Given any $y > x$, we have
  \[
    f'(y)(y - x) \geq f(y) - f(x) \geq f'(x)(y - x).
  \]
  Hence $f'(y) \geq f'(x)$ whenever $y > x$,
  or $f'$ is monotonically increasing.
  \end{enumerate}

\item[(2)]
  \emph{Show that $f$ is convex if $f'$ is monotonically increasing.}
  Given any $y > x$ and any $0 < \lambda < 1$.
  \begin{enumerate}
  \item[(a)]
  By Theorem 5.10 (the mean value theorem), there is a point $x < \xi < y$ such that
  \[
    f(y) - f(x) = f'(\xi)(y - x).
  \]
  Since $f'$ is monotonically increasing,
  \[
    f'(y)(y - x) \geq f(y) - f(x) \geq f'(x)(y - x).
  \]

  \item[(b)]
  Write $z = \lambda x + (1-\lambda)y$.
  Hence
  \begin{align*}
    f(y)-f(z) &\geq f'(z)(y-z), \\
    f(z)-f(x) &\leq f'(z)(z-x),
  \end{align*}
  or
  \begin{align*}
    f(y) &\geq f(z) + f'(z)(y-z), \\
    f(x) &\geq f(z) + f'(z)(x-z),
  \end{align*}
  or
  \begin{align*}
    \lambda f(x) + (1-\lambda)f(y)
    \geq&
    \lambda [f(z) + f'(z)(x-z)] \\
      &+ (1-\lambda)[f(z) + f'(z)(y-z)] \\
    =& f(z) \\
    =& f(\lambda x + (1-\lambda)y).
  \end{align*}
  Hence $f$ is convex.
  \end{enumerate}

\item[(3)]
  \emph{Show that $f''(x) \geq 0$ if $f$ is convex and $f''$ exists.}
  By (1), $f'$ is monotonically increasing since $f$ is convex.
  Given any $x \neq y$, we have
  \[
    \frac{f'(y)-f'(x)}{y - x} \geq 0.
  \]
  Let $y \to x$, we have $f''(x) \geq 0$ if $f''$ exists.

\item[(4)]
  \emph{Show that $f$ is convex if $f''$ exists and $f''(x) \geq 0$.}
  By Theorem 5.11(a), $f'$ is monotonically increasing.
  By (2), $f$ is convex.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.15 (Landau-Kolmogorov inequality on the half-line).}
\emph{Suppose $a \in \mathbb{R}^1$,
$f$ is a twice-differentiable real function on $(a,\infty)$,
and $M_0$, $M_1$, $M_2$ are the least upper bounds of
$|f(x)|$, $|f'(x)|$, $|f''(x)|$, respectively, on $(a,\infty)$.
Prove that
\[
  M_1^2 \leq 4 M_0 M_2.
\]
(Hint: If $h>0$, Taylor's theorem shows that
\[
  f'(x) = \frac{1}{2h} [ f(x+2h) - f(x) ] - h f''(\xi)
\]
for some $\xi \in (x,x+2h)$.
Hence
\[
  |f'(x)| \leq h M_2 + \frac{M_0}{h}.)
\]}

\emph{To show that $M_1^2=4 M_0 M_2$ can actually happen, take $a=-1$, define
\begin{equation*}
  f(x) =
    \begin{cases}
      2x^2 - 1            & (-1 < x < 0), \\
      \frac{x^2-1}{x^2+1} & (0 \leq x < \infty),
    \end{cases}
\end{equation*}
and show that $M_0 = 1$, $M_1 = 4$, $M_2 = 4$.}
\emph{Does $M_1 ^2 \leq 4 M_0 M_2$ hold for vector-valued functions too?} \\



\emph{Note.}
\begin{enumerate}
\item[(1)]
Write
\[
  M_1 \leq 2 M_0^{\frac{1}{2}} M_2^{\frac{1}{2}}.
\]
$2$ is called the Landau-Kolmogorov constant,
which is the best possible by the above example.

\item[(2)]
In general,
suppose $a \in \mathbb{R}^1$,
$f$ is a $n$th differentiable real function on $(a,\infty)$,
and $M_0$, $M_k$, $M_n$ are the least upper bounds of
$\abs{ f(x) }$, $\abs{ f^{(k)}(x) }$, $\abs{ f^{(n)}(x) }$, respectively, on $(a,\infty)$
where $1 \leq k < n$.
Then
\[
  M_k \leq C(n,k) M_0^{1 - \frac{k}{n}} M_n^{\frac{k}{n}}.
\]
\end{enumerate}



\emph{Proof.}
\begin{enumerate}
\item[(1)]
  Consider some trivial cases.
  \begin{enumerate}
  \item[(a)]
  If $M_0 = 0$, then $f(x) = 0$ on $(a,+\infty)$.
  So that $f'(x) = f''(x) = 0$ on $(a,+\infty)$, or $M_1 = M_2 = 0$.
  The inequality holds.

  \item[(b)]
  If $M_2 = 0$, then $f''(x) = 0$ on $(a,+\infty)$.
  So that $f'(x) = \alpha$ for some constant $\alpha \in \mathbb{R}^1$ (Theorem 5.11(b)),
  and $f(x) = \alpha x + \beta$ for some constant $\beta \in \mathbb{R}^1$
  (by applying Theorem 5.11(b) to $x \mapsto f(x) - \alpha x$).
  Hence $M_1 = |\alpha|$ and
  \begin{equation*}
  M_0 =
    \begin{cases}
      +\infty & (\alpha \neq 0), \\
      |\beta| & (\alpha = 0).
    \end{cases}
  \end{equation*}
  In any case, the inequality holds.

  \item[(c)]
  If $M_0 = +\infty$ and $M_2 \neq 0$, there is nothing to do.

  \item[(d)]
  If $M_2 = +\infty$ and $M_0 \neq 0$, there is nothing to do.
  \end{enumerate}

\item[(2)]
By (1), we suppose that $0 < M_0 < +\infty$ and $0 < M_2 < +\infty$.
Given $x \in (a,+\infty)$ and $h>0$.
By Taylor's theorem (Theorem 5.15):
\[
  f(x+2h) = f(x) + 2h f'(x) + 2 h^2 f''(\xi)
\]
for some $\xi \in (x,x+2h) \subseteq (a,+\infty)$.
Thus
\begin{align*}
  2h|f'(x)|
  &\leq |f(x+2h)| + |f(x)| + 2 h^2 |f''(\xi)| \\
  &\leq 2 M_0 + 2 h^2 M_2, \\
  |f'(x)|
  &\leq \frac{M_0}{h} + h M_2
\end{align*}
holds for all $h > 0$.
In particular, take
\[
  h = \sqrt{\frac{M_0}{M_2}}
\]
to get
\[
  |f'(x)| \leq 2 \sqrt{M_0 M_2}.
\]
Thus $2 \sqrt{M_0 M_2}$ is an upper bound of $|f'(x)|$ for all $x \in (a,+\infty)$.
Hence
\[
  M_1 \leq 2 \sqrt{M_0 M_2}
\]
or
\[
  M_1^2 \leq 4 M_0 M_2.
\]

\item[(3)]
\emph{Define
\begin{equation*}
  f(x) =
    \begin{cases}
      2x^2 - 1            & (-1 < x < 0), \\
      \frac{x^2-1}{x^2+1} & (0 \leq x < \infty).
    \end{cases}
\end{equation*}
Show that $M_0 = 1$, $M_1 = 4$, $M_2 = 4$.}
Similar to Exercise 5.12,
\begin{equation*}
  f'(x) =
    \begin{cases}
      4x                   & (-1 < x \leq 0), \\
      \frac{4x}{(x^2+1)^2} & (0 \leq x < \infty).
    \end{cases}
\end{equation*}
(Here $\lim_{x \to 0+} f'(x) = 0$ and $\lim_{x \to 0-} f'(x) = 0$.
So $f'(0) = 0$ by Exercise 5.9.)
Also,
\begin{equation*}
  f''(x) =
    \begin{cases}
      4                          & (-1 < x \leq 0), \\
      \frac{-12x^2+4}{(x^2+1)^3} & (0 \leq x < \infty).
    \end{cases}
\end{equation*}
(Here $\lim_{x \to 0+} f''(x) = 4$ and $\lim_{x \to 0-} f''(x) = 4$.
So $f''(0) = 4$ by Exercise 5.9.)
Hence, $M_0 = 1$, $M_1 = 4$, $M_2 = 4$.

\item[(4)]
\emph{Given
\[
  \mathbf{f}(x) = (f_1(x), \ldots, f_k(x))
\]
be a twice-differentiable vector-valued function from $(a,\infty)$ to $\mathbb{R}^k$.
and $M_0$, $M_1$, $M_2$ are the least upper bounds of
$|\mathbf{f}(x)|$, $|\mathbf{f}'(x)|$, $|\mathbf{f}''(x)|$, respectively, on $(a,\infty)$.
Show that
\[
  M_1^2 \leq 4 M_0 M_2.
\]}

Similar to (1), we suppose that $0 < M_0 < +\infty$ and $0 < M_2 < +\infty$.
Given any $\mathbf{v} = (v_1, \ldots, v_k) \in \mathbb{R}^k$,
$\mathbf{v} \cdot \mathbf{f}$ is a twice-differentiable real function on $(a,\infty)$.
Similar to (2),
Given $x \in (a,+\infty)$ and $h>0$.
By Taylor's theorem (Theorem 5.15):
\[
  (\mathbf{v} \cdot \mathbf{f})(x+2h)
  = (\mathbf{v} \cdot \mathbf{f})(x)
    + 2h (\mathbf{v} \cdot \mathbf{f})'(x)
    + 2 h^2 (\mathbf{v} \cdot \mathbf{f})''(\xi)
\]
for some $\xi \in (x,x+2h) \subseteq (a,+\infty)$.
Thus by the Schwarz inequality (Theorem 1.37(d))
\begin{align*}
  2h|(\mathbf{v} \cdot \mathbf{f})'(x)|
  &\leq |(\mathbf{v} \cdot \mathbf{f})(x+2h)|
    + |(\mathbf{v} \cdot \mathbf{f})(x)|
    + 2 h^2 |(\mathbf{v} \cdot \mathbf{f})''(\xi)| \\
  &\leq |\mathbf{v}| |\mathbf{f}(x+2h)|
    + |\mathbf{v}||\mathbf{f}(x)|
    + 2 h^2 |\mathbf{v}| |\mathbf{f}''(\xi)| \\
  &\leq (2 M_0 + 2 h^2 M_2)|\mathbf{v}|, \\
  |(\mathbf{v} \cdot \mathbf{f})'(x)|
  &\leq \left(\frac{M_0}{h} + h M_2\right)|\mathbf{v}|
\end{align*}
holds for any $\mathbf{v}$ and $h > 0$.
In particular, we take
\[
  \mathbf{v} = \mathbf{f}'(y)
\]
and
\[
  h = \sqrt{\frac{M_0}{M_2}}
\]
to get
\[
  |\mathbf{f}'(x) \cdot \mathbf{f}'(y)|
  \leq 2 \sqrt{M_0 M_2} |\mathbf{f}'(y)|
  \leq 2 M_1 \sqrt{M_0 M_2}.
\]
Note that $x$ and $y$ are arbitrary (in $(a,+\infty)$).
In particular, we take $x = y$ to get
\[
  |\mathbf{f}'(x)|^2 \leq 2 M_1 \sqrt{M_0 M_2}.
\]
Thus $2 M_1 \sqrt{M_0 M_2}$ is an upper bound of $|\mathbf{f}'(x)|^2$ for all $x \in (a,+\infty)$.
Hence
\[
  M_1^2 \leq 2 M_1 \sqrt{M_0 M_2}
\]
or
\[
  M_1^2 \leq 4 M_0 M_2.
\]
\end{enumerate}
$\Box$ \\

\textbf{Supplement (Landau-Kolmogorov inequality on the real line).}
\emph{Suppose $f$ is a twice-differentiable real function on $(-\infty,+\infty)$,
and $M_0$, $M_1$, $M_2$ are the least upper bounds of
$|f(x)|$, $|f'(x)|$, $|f''(x)|$, respectively, on $(-\infty,+\infty)$.
Prove that
\[
  M_1^2 \leq 2 M_0 M_2.
\]}

\emph{Proof.}
\begin{enumerate}
\item[(1)]
Similar to (1) in Landau-Kolmogorov inequality on the half-line,
we suppose that $0 < M_0 < +\infty$ and $0 < M_2 < +\infty$.

\item[(2)]
Similar to (2) in Landau-Kolmogorov inequality on the half-line.
Given $x \in \mathbb{R}^1$ and $h>0$.
By Taylor's theorem (Theorem 5.15):
\begin{align*}
  f(x+2h) &= f(x) + 2h f'(x) + 2 h^2 f''(\xi_1) \tag{I} \\
  f(x-2h) &= f(x) - 2h f'(x) + 2 h^2 f''(\xi_2) \tag{II}
\end{align*}
for some $\xi_1 \in (x,x+2h)$ and $\xi_2 \in (x,x-2h)$.
So (I) subtracts (II):
\[
  f(x+2h)-f(x-2h) = 4h f'(x) + 2 h^2 f''(\xi_1) - 2 h^2 f''(\xi_2).
\]
Thus
\begin{align*}
  4h|f'(x)|
  &\leq |f(x+2h)| + |f(x-2h)| + 2 h^2 |f''(\xi_1)| + 2 h^2 |f''(\xi_2)| \\
  &\leq 2 M_0 + 4 h^2 M_2, \\
  |f'(x)|
  &\leq \frac{M_0}{2h} + h M_2
\end{align*}
holds for all $h > 0$.
In particular, take
\[
  h = \sqrt{\frac{M_0}{2M_2}}
\]
to get
\[
  |f'(x)| \leq \sqrt{2 M_0 M_2}.
\]
Thus $\sqrt{2 M_0 M_2}$ is an upper bound of $|f'(x)|$ for all $x \in \mathbb{R}^1$.
Hence
\[
  M_1 \leq \sqrt{2 M_0 M_2}
\]
or
\[
  M_1^2 \leq 2 M_0 M_2.
\]
\end{enumerate}
$\Box$ \\

\emph{Note.}
\begin{enumerate}
\item[(1)]
Write
\[
  M_1 \leq \sqrt{2} M_0^{\frac{1}{2}} M_2^{\frac{1}{2}}.
\]
$\sqrt{2}$ is called the Landau-Kolmogorov constant,
which is the best possible.

\item[(2)]
In general,
suppose $f$ is a $n$th differentiable real function on $\mathbb{R}^1$,
and $M_0$, $M_k$, $M_n$ are the least upper bounds of
$\abs{ f(x) }$, $\abs{ f^{(k)}(x) }$, $\abs{ f^{(n)}(x) }$, respectively, on $\mathbb{R}^1$
where $1 \leq k < n$.
Then
\[
  M_k \leq C(n,k) M_0^{1 - \frac{k}{n}} M_n^{\frac{k}{n}}.
\] \\
\end{enumerate}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.16.}
\emph{Suppose $f$ is twice-differentiable on $(0,\infty)$,
$f''$ is bounded on $(0,\infty)$,
and $f(x) \to 0$ as $x \to \infty$.
Prove that $f'(x) \to 0$ as $x \to \infty$.
(Hint: Let $a \to \infty$ in Exercise 5.15.)} \\

\emph{Proof.}
\begin{enumerate}
\item[(1)]
Write $|f''| \leq M$ for some real $M$ since $f''$ is bounded on $(0,\infty)$.

\item[(2)]
Given any $a > 0$.
As in Exercise 5.15, define $M_0, M_1, M_2$ are the least upper bounds of
$|f(x)|$, $|f'(x)|$, $|f''(x)|$ on $(a,\infty)$.
Note that $M_2 \leq M$ for any $a > 0$ (by (1)).
So that
\[
  M_1^2 \leq 4 M_0 M_2 \leq 4M M_0
\]
for any $a > 0$.

\item[(3)]
By assumption, $M_0 \to 0$ as $a \to \infty$.
(So given any $\varepsilon > 0$, there exists a real $A$ such that
\[
  0 \leq M_0 < \frac{\varepsilon}{4M + 1}
\]
whenever $a \geq A$.
Hence
\[
  M_1^2 \leq 4M M_0 \leq 4M \cdot \frac{\varepsilon}{4M + 1} < \varepsilon.
\]
whenever $a \geq A$.)
Therefore $M_1^2 \to 0$ as $a \to \infty$,
or $f'(x) \to 0$ as $x \to \infty$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.17.}
\emph{Suppose $f$ is a real, three times differentiable function on $[-1,1]$, such that
\[
  f(-1)=0, \:\:\:\:\:\:\:\:
  f(0)=0, \:\:\:\:\:\:\:\:
  f(1)=1, \:\:\:\:\:\:\:\:
  f'(0)=0.
\]
Prove that $f^{(3)}(x) \geq 3$ for some $x \in (-1,1)$.
Note that equality holds for $\frac{1}{2}(x^3+x^2)$.
(Hint: Use Theorem 5.15, with $\alpha = 0$ and $\beta=\pm 1$,
to show that there exist $s \in (0,1)$ and $t \in (-1,0)$ such that
\[
  f^{(3)}(s) + f^{(3)}(t) = 6.)
\]}

We can drop the assumption that $f(0)=0$ actually. \\

\emph{Proof (Hint).}
\begin{enumerate}
\item[(1)]
Use Taylor's theorem (Theorem 5.15), with $\alpha = 0$ and $\beta=\pm 1$,
\begin{align*}
  f(1) &= f(0) + f'(0) + \frac{f''(0)}{2} + \frac{f'''(s)}{6} \tag{I} \\
  f(-1) &= f(0) - f'(0) + \frac{f''(0)}{2} - \frac{f'''(t)}{6} \tag{II}
\end{align*}
for some $s \in (0,1)$ and $t \in (-1,0)$.

\item[(2)]
(I) subtracts (II) implies that
\[
  f(1) - f(-1) = 2 f'(0) + \frac{f'''(s)}{6} + \frac{f'''(t)}{6}.
\]
By assumption, $f(-1)=0$, $f(1)=1$ and $f'(0)=0$.
Hence
\[
  f^{(3)}(s) + f^{(3)}(t) = 6
\]
for some $s \in (0,1)$ and $t \in (-1,0)$.
So either $f^{(3)}(s) \geq 3$ or $f^{(3)}(t) \geq 3$
for some $s, t \in (-1,1)$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.18.}
\emph{Suppose $f$ is a real function on $[a,b]$, $n$ is a positive integer,
and $f^{(n-1)}$ exists for every $t \in [a,b]$.
Let $\alpha$, $\beta$, and $P$ be as in Taylor's theorem (Theorem 5.15).
Define
\[
  Q(t) = \frac{f(t) - f(\beta)}{t - \beta}
\]
for $t \in [a,b]$, $t \neq \beta$, differentiate
\[
  f(t) - f(\beta) = (t - \beta)Q(t)
\]
$n-1$ times at $t = \alpha$,
and derive the following version of Taylor's theorem:
\[
  f(\beta) = P(\beta)
    + \frac{Q^{(n-1)}(\alpha)}{(n-1)!} (\beta - \alpha)^n.
\]} \\

\emph{Proof.}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.19.}
\emph{Suppose $f$ is defined in $(-1,1)$ and $f'(0)$ exists.
Suppose $-1 < \alpha_n < \beta_n < 1$, $\alpha_n \rightarrow 0$,
and $\beta_n \rightarrow 0$ as $n \rightarrow \infty$.
Define the difference quotients
\[
  D_n = \frac{f(\beta_n) - f(\alpha_n)}{\beta_n - \alpha_n}
\]
Prove the following statements:}
\begin{enumerate}
  \item[(a)]
  \emph{If $\alpha_n < 0 < \beta_n$, then $\lim{D_n} = f'(0)$.}

  \item[(b)]
  \emph{If $0 < \alpha_n < \beta_n$ and $\left\{\frac{\beta_n}{\beta_n-\alpha_n}\right\}$ is bounded,
  then $\lim{D_n} = f'(0)$.}

  \item[(c)]
  \emph{If $f'$ is continuous in $(-1,1)$, then $\lim{D_n} = f'(0)$}.
\end{enumerate}
\emph{Give an example in which $f$ is differentiable in $(-1,1)$
(but $f'$ is not continuous at $0$) and in which
$\alpha_n$, $\beta_n$ tend to $0$ in such a way that $\lim{D_n}$ exists
but is different from $f'(0)$.} \\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.20.}
\emph{Formulate and prove an inequality which follows form Taylor's theorem and
which remains valid for vector-valued function.} \\

\emph{Proof.}
\begin{enumerate}
  \item[(a)]
  \emph{Suppose $\mathbf{f}$ is a function of $[a,b]$ into $\mathbb{R}^{m}$,
  $n$ is a positive integer,
  $\mathbf{f}^{(n-1)}$ is continuous on $[a,b]$,
  $\mathbf{f}^{(n)}(t)$ exists for every $t \in (a,b)$.
  Let $\alpha$, $\beta$ be distinct points of $[a,b]$, and define
  \[
    \mathbf{P}(t) = \sum_{k=0}^{n-1} \frac{\mathbf{f}^{(k)}(\alpha)}{k!}(t - \alpha)^k.
  \]
  Then there exists a point $x$ between $\alpha$ and $\beta$ such that}
  \[
    \abs{ \mathbf{f}(\beta) - \mathbf{P}(\beta) }
    \leq (\beta - \alpha)^n \abs{\frac{\mathbf{f}^{(n)}(x)}{n!}}.
  \]

  For $n = 1$, this is just Theorem 5.19.

  \item[(b)]
  Similar to the proof of Theorem 5.19.
  Put
  \[
    \mathbf{z} = \mathbf{f}(\beta) - \mathbf{P}(\beta).
  \]
  Define
  \[
    \varphi(t) = \mathbf{z} \cdot \mathbf{f}(t)
    \:\:\:\:\:\:\:\: (\alpha \leq t \leq \beta).
  \]
  Then $\varphi(t)$ is a function of $[a,b]$ into $\mathbb{R}^1$, and
  \[
    \varphi^{(k)}(t) = \mathbf{z} \cdot \mathbf{f}^{(k)}(t)
  \]
  where $0 \leq k \leq n$.
  Also, $\varphi^{(n-1)}$ is continuous on $[\alpha,\beta]$,
  and $\varphi^{(n)}(t)$ exists for every $t \in (\alpha,\beta)$.

  \item[(c)]
  By Taylor's theorem (Theorem 5.15), there exists $x \in (\alpha,\beta)$ such that
  \[
    \varphi(\beta) = Q(\beta) + \frac{\varphi^{(n)}(x)}{n!}(\beta-\alpha)^n
  \]
  where
  \[
    Q(t) = \sum_{k=0}^{n-1} \frac{\varphi^{(k)}(\alpha)}{k!}(t - \alpha)^k.
  \]
  By (b), we have $Q(t) = \mathbf{z} \cdot \mathbf{P}(t)$ and thus
  \[
    \mathbf{z} \cdot (\mathbf{f}(\beta) - \mathbf{P}(\beta))
    = \mathbf{z} \cdot \frac{\mathbf{f}^{(n)}(x)}{n!}(\beta-\alpha)^n.
  \]
  Note that $\mathbf{z} = \mathbf{f}(\beta) - \mathbf{P}(\beta)$
  and Schwarz inequality (Theorem 1.37(d)).
  Hence
  \begin{align*}
    |\mathbf{f}(\beta) - \mathbf{P}(\beta)|^2
    &=
    \abs{ (\mathbf{f}(\beta) - \mathbf{P}(\beta))
      \cdot \frac{\mathbf{f}^{(n)}(x)}{n!}(\beta-\alpha)^n } \\
    &\leq
      \abs{ \mathbf{f}(\beta) - \mathbf{P}(\beta) }
      \abs{ \frac{\mathbf{f}^{(n)}(x)}{n!} } (\beta-\alpha)^n
  \end{align*}
  or
  \[
    |\mathbf{f}(\beta) - \mathbf{P}(\beta)|
    \leq \abs{ \frac{\mathbf{f}^{(n)}(x)}{n!} } (\beta-\alpha)^n
  \]
  (whether $\mathbf{f}(\beta) - \mathbf{P}(\beta)$ is zero nor not).
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.21.}
\emph{Let $E$ be a closed subset of $\mathbb{R}^1$.
We saw in Exercise 4.22, that there is a real continuous function $f$ on $\mathbb{R}^1$
whose zero set is $E$.
Is it possible, for each closed set $E$,
to find such an $f$ which is differentiable on $\mathbb{R}^1$,
or one which is $n$ times differentiable,
or even one which has derivatives of all orders on $\mathbb{R}^1$?} \\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.22.}
\emph{Suppose $f$ is a real function on $(-\infty,+\infty)$.
Call $x$ a \textbf{fixed point} of $f$ if $f(x)=x$.}
\begin{enumerate}
  \item[(a)]
  \emph{If $f$ is differentiable and $f'(t) \neq 1$ for every real $t$,
  prove that $f$ has at most one fixed point.}

  \item[(b)]
  \emph{Show that the function $f$ defined by
  \[
    f(t) = t+(1+e^t)^{-1}
  \]
  has no fixed point, although $0 < f'(t) < 1$ for all real $t$.}

  \item[(c)]
  \emph{However, if there is a constant $A<1$ such that $|f'(t)| \leq A$ for all real $t$,
  prove that a fixed point $x$ of $f$ exists,
  and that $x = \lim x_n$, where $x_1$ is an arbitrary real number and
  \[
    x_{n+1} = f(x_n)
  \]
  for $n = 1,2,3,\ldots$.}

  \item[(d)]
  \emph{Show that the process describe in (c) can be visualized by the zig-zag path
  \[
    (x_1,x_2) \to (x_2,x_2) \to (x_2,x_3) \to (x_3,x_3) \to (x_3,x_4) \to \ldots.
  \]}
  \end{enumerate}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.23.}
\emph{The function $f$ defined by
\[
  f(x) = \frac{x^3 + 1}{3}
\]
has three fixed points, say $\alpha$, $\beta$, $\gamma$, where
\[
  −2 < \alpha < −1, \:\:\:\:\:\:\:\:
  0 < \beta < 1, \:\:\:\:\:\:\:\:
  1 < \gamma < 2.
\]
For arbitrarily chosen $x_1$, define $\{x_n\}$ by setting $x_{n+1} = f(x_n)$.}
\begin{enumerate}
  \item[(a)]
  \emph{If $x_1 < \alpha$, prove that $x_n \to -\infty$ as $n \to \infty$.}

  \item[(b)]
  \emph{$If \alpha < x_1 < \gamma$, prove that $x_n \to \beta$ as $n \to \infty$.}

  \item[(c)]
  \emph{If $\gamma < x_1$, prove that $x_n \to +\infty$ as $n \to \infty$.}
  \end{enumerate}
\emph{Thus $\beta$ can be located by this method,
but $\alpha$ and $\gamma$ cannot.} \\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.24.}
\emph{The process described in part (c) of Exercise 5.22 can of course also be applied to
functions that map $(0,\infty)$ to $(0,\infty)$.
Fix some $\alpha > 1$, and put
\[
  f(x) = \frac{1}{2} \left( x + \frac{\alpha}{x} \right), \:\:\:\:\:\:\:\:
  g(x) = \frac{\alpha + x}{1 + x}.
\]
Both $f$ and $g$ have $\sqrt{\alpha}$ as their fixed point in $(0,\infty)$.
Try to explain, on the basis of properties of $f$ and $g$,
why the convergence in Exercise 3.16, is so much more rapid than it is in Exercise 3.17.
(Compare $f'$ and $g'$, draw the zig-zags suggested in Exercise 5.22.)} \\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.25.}
\emph{Suppose $f$ is twice differentiable on $[a,b]$,
$f(a) < 0$, $f(b) > 0$, $f'(x) \geq \delta > 0$,
and $0 \leq f''(x) \leq M$ for all $x \in [a,b]$.
Let $\xi$ be the unique point in $(a,b)$ at which $f(\xi) = 0$.
Complete the details in the following outline of
\textbf{Newton's method} for computing $\xi$.}
\begin{enumerate}
\item[(a)]
\emph{Choose $x_1 \in (\xi,b)$, and define $\{ x_n \}$ by
\[
  x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}.
\]
Interpret this geometrically, in terms of a tangent to the graph of $f$.}

\item[(b)]
\emph{Prove that $x_{n+1} < x_n$ and that
\[
  \lim_{n \to \infty}{x_n} = \xi.
\]}
\item[(c)]
\emph{Use Taylor's theorem to show that
\[
  x_{n+1} - \xi = \frac{f''(t_n)}{2 f'(x_n)} (x_n-\xi)^2
\]
for some $t_n \in (\xi,x_n)$.}

\item[(d)]
\emph{(Quadratic convergence)
If $A = \frac{M}{2\delta}$, deduce that
\[
  0 \leq x_{n+1} - \xi \leq \frac{1}{A} [A(x_1 - \xi)]^{2^n}.
\]
(Compare with Exercise 3.16 and 3.18.)}

\item[(e)]
\emph{Show that Newton's method amounts to finding a fixed point of the function $g$ defined by
\[
  g(x) = x - \frac{f(x)}{f'(x)}.
\]
How does $g'(x)$ behave for $x$ near $\xi$?}

\item[(f)]
\emph{Put $f(x) = x^{\frac{1}{3}}$ on $(-\infty, +\infty)$ and try Newton's method.
What happens?} \\
\end{enumerate}



\emph{Proof of (a) (Wikipedia).}
The equation of the tangent line to the curve $y = f(x)$ at $x = x_n$ is
\[
  y = f'(x_n)(x - x_n) + f(x_n).
\]
The $x$-intercept of this line (the value of $x$ which makes $y = 0$)
is taken as the next approximation, $x_{n+1}$, to the root,
so that the equation of the tangent line is satisfied when
$(x,y) = (x_{n+1},0)$:
\[
  0 = f'(x_n)(x - x_n) + f(x_n).
\]
Solving for $x_{n+1}$ gives
\[
  x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}.
\]
$\Box$ \\



\emph{Proof of (b).}
\begin{enumerate}
\item[(1)]
\emph{Show that $x_n \geq \xi$ for all $n$.}
Induction on $n$.
  \begin{enumerate}
  \item[(a)]
  $n = 1$ is clearly true: $x_1 > \xi$ by assumption.

  \item[(b)]
  Assume the induction hypothesis that for the single case $n = k$ holds.
  By the mean value theorem (Theorem 5.10),
  there is a point $\xi_k \in (\xi, x_k)$
  \[
    f(x_k) - f(\xi) = f'(\xi_k)(x_k - \xi),
  \]
  or
  \[
    f(x_k) = f'(\xi_k)(x_k - \xi)
  \]
  (since $f(\xi) = 0$).
  Since $f'' \geq 0$, $f'$ is monotonically increasing (Theorem 5.11(a)).
  Hence $f'(\xi_k) \leq f'(x_k)$ and thus
  \[
    f(x_k)
    = f'(\xi_k)(x_k - \xi)
    \leq f'(x_k)(x_k - \xi).
  \]
  Since $f'(x_k) > 0$ by assumption,
  \[
    \xi \leq x_k - \frac{f(x_k)}{f'(x_k)} = x_{k+1}.
  \]

  \item[(c)]
  Since both the base case in (a) and
  the inductive step in (b) have been proved as true,
  by mathematical induction $x_n \geq \xi$ for all $n$.
  \end{enumerate}

\item[(2)]
\emph{Show that $x_{n+1} < x_n$ for all $n$.}
  \begin{enumerate}
  \item[(a)]
  Since $f' > 0$, $f'(x_n) > 0$ for all $n$.

  \item[(b)]
  Since $f' > 0$, $f$ is strictly increasing (Theorem 5.10).
  Hence $f(x_n) > f(\xi) = 0$ for all $n$ (by (1)).

  \item[(c)]
  By (a)(b), $\frac{f(x_n)}{f'(x_n)} > 0$ or
  \[
    x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)} < x_n.
  \]
  \end{enumerate}

\item[(3)]
By Theorem 3.14, $\{x_n\}$ converges to some real number $\zeta \geq \xi$.
Note that $f$ and $f'$ are continuous by the existence of $f''$ (Theorem 5.2),
we have
\[
  \lim_{n \to \infty} x_{n+1}
  = \lim_{n \to \infty} x_n - \frac{f(\lim_{n \to \infty} x_n)}{f'(\lim_{n \to \infty} x_n)}
\]
provided $f' \neq 0$ (Theorem 4.9 and Theorem 4.4).
Hence
\[
  \zeta = \zeta - \frac{f(\zeta)}{f'(\zeta)}
\]
or $f(\zeta) = 0$.
By the uniqueness of $\xi$, $\zeta = \xi$ or $\lim x_n = \xi$ as desired.
\end{enumerate}
$\Box$ \\



\emph{Proof of (c).}
By Taylor's theorem (Theorem 5.15),
\[
        f(\xi) = f(x_n) + f'(x_n)(\xi - x_n) + \frac{f''(t_n)}{2}(\xi - x_n)^2
\]
for some $t_n \in (\xi, x_n)$.
Note that $f(\xi) = 0$, $f'(x_n) \neq 0$ and $x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$,
we have the desired result.
$\Box$ \\



\emph{Proof of (d).}
Clearly, $0 \leq x_{n+1} - \xi$ for all $n$ (by (b)).
Besides, by (c)
\[
  x_{n+1} - \xi = \frac{f''(t_n)}{2 f'(x_n)} (x_n-\xi)^2
\]
Note that $f'' \leq M$ and $f' \geq \delta > 0$ by assumption, and thus
\[
  x_{n+1} - \xi
  \leq \frac{M}{2\delta} (x_n - \xi)^2 = A (x_n - \xi)^2.
\]
By induction,
\[
  x_{n+1} - \xi \leq \frac{1}{A}(A(x_1-\xi))^{2^n}.
\]
$\Box$ \\

\emph{Note.}
Compare with Exercise 3.16 and Exercise 3.18.
Might assume that $p > 1$.
\begin{enumerate}
\item[(1)]
Fix a positive number $\alpha$.
Let $f(x) = x^p - \alpha$ on $E = (a,b)$
where $a = \frac{1}{2} \alpha^{\frac{1}{p}}$ and
\begin{equation*}
  b =
    \begin{cases}
      2 \alpha^{\frac{1}{p}}
      & (p = 2), \\
      \left( \frac{2(p-1)}{p} \right)^{\frac{1}{p-2}} \alpha^{\frac{1}{p}}
      & (p > 2).
    \end{cases}
\end{equation*}
$E = (a,b)$ is well-defined since $a < b$.
Besides, $\xi = \alpha^{\frac{1}{p}} \in E = (a,b)$.

\item[(2)]
By construction,
\[
  f(a) < 0 \text{ and } f(b) > 0.
\]
By $f'(x) = px^{p-1}$ and $f''(x) = p(p-1)x^{p-2}$,
\begin{align*}
  f'(x) &\geq pa^{p-1} > 0, \\
  0 \leq f''(x) &\leq p(p-1)b^{p-2}.
\end{align*}
on $E$.
Write
\begin{align*}
  \delta &= pa^{p-1} = \frac{p}{2^{p-1}} \alpha^{\frac{p-1}{p}}, \\
  M &= p(p-1)b^{p-2} = 2 (p-1)^2 \alpha^{\frac{p-2}{p}}.
\end{align*}

\item[(3)]
Hence the Newton's method works for $f(x) = x^p - \alpha$.
That is, as we define $\{x_n\}$ by
\[
  x_{n+1}
  = x_n - \frac{f(x_n)}{f'(x_n)}
  = \frac{p-1}{p}x_n + \frac{\alpha}{p} x_n^{-p+1},
\]
we have $\lim x_n = \xi = \alpha^{\frac{1}{p}}$.
And
\[
  0 \leq x_{n+1} - \xi \leq \frac{1}{A}(A(x_1-\xi))^{2^n}.
\]
Here
\[
  A = \frac{M}{2 \delta} = \frac{2^{p-1}(p-1)^2}{p \alpha^{\frac{1}{p}}}.
\]

\item[(4)]
Note that
\[
  \beta
  = \frac{p \alpha^{\frac{1}{p}}}{(p-1)^2}
  \neq \frac{p \alpha^{\frac{1}{p}}}{2^{p-1}(p-1)^2} = \frac{1}{A}.
\]
where $\beta$ is defined in the proof of Exercise 3.18.
Note that $f'(x_n) \geq f'(\xi)$
(since $f'$ is monotonically increasing and all $x_n \geq \xi$),
and thus $A$ can be chosen by a better estimation:
\[
  A = \frac{M}{2 f'(\xi)} = \frac{(p-1)^2}{p \alpha^{\frac{1}{p}}} = \frac{1}{\beta}.
\]
Now it is exactly the same as Exercise 3.16 and Exercise 3.18. \\
\end{enumerate}



\emph{Proof of (e).}
\begin{enumerate}
\item[(1)]
Define $g(x) = x - \frac{f(x)}{f'(x)}$ on $[a,b]$.
$g(\xi) = \xi$ if and only if $f(\xi) = 0$.

\item[(2)]
By the construction of $g$, $g$ is differentiable and
\[
  g'(x)
  = 1 - \frac{f'(x)^2 - f(x) f''(x)}{f'(x)^2}
  = \frac{f(x) f''(x)}{f'(x)^2}.
\]

\item[(3)]
Hence
\[
  |g'(x)|
  \leq \abs{\frac{f(x) f''(x)}{f'(x)^2}}
  = \frac{|f(x)| |f''(x)|}{|f'(x)|^2}
  \leq \frac{M}{\delta^2} |f(x)|.
\]
As $x \to \xi$, $|f(x)| \to 0$.
Therefore,
$|g'(x)| \to 0$ or $g'(x) \to 0$ as $x \to \xi$.
\end{enumerate}
$\Box$ \\



\emph{Proof of (f).}
\begin{enumerate}
\item[(1)]
It is clearly that $f(x) = 0$ if and only if $x = 0$.
Write $\xi = 0$.

\item[(2)]
Note that
\[
  x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)} = -2 x_n,
\]
or
\[
  x_n = (-2)^{n-1} x_1
\]
for any $x_1 \in (\xi, \infty)$ where $n = 1, 2, 3, \ldots$.
Hence, the sequence $\{x_n\}$ does not converge for any choice of $x_1 \in (\xi, \infty)$.
In this case we cannot find $\xi$ satisfying $f(\xi) = 0$ by Newton's method.

\item[(3)]
In fact,
\[
  f'(x) = \frac{1}{3} x^{-\frac{2}{3}} \to 0 \text{ as } x \to \pm \infty.
\]
Hence such $\delta > 0$ satisfying $f'(x) \geq \delta > 0$ does not exist.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.26.}
\emph{Suppose $f$ is differentiable on $[a,b]$, $f(a) = 0$,
and there is a real number $A$ such that $|f'(x)| \leq A|f(x)|$ on $[a,b]$.
Prove that $f(x)=0$ for all $x \in [a,b]$.
(Hint: Fix $x_0 \in [a,b]$, let
\[
  M_0 = \sup{|f(x)|}, \:\:\:\:\:\:\:\: M_1 = \sup{|f'(x)|}
\]
for $a \leq x \leq x_0$.
For any such $x$,
\[
  |f(x)| \leq M_1(x_0-a) \leq A(x_0-a) M_0.
\]
Hence $M_0 = 0$ if $A(x_0-a) < 1$.
That is, $f = 0$ on $[a,x_0]$.
Proceed.)} \\

\emph{Proof (Hint).}
\begin{enumerate}
\item[(1)]
If $A = 0$, then $f'(x) = 0$ or $f(x)$ is constant on $[a,b]$ (Theorem 5.11(b)).
Since $f(a) = 0$, $f(x) = 0$ on $[a,b]$.

\item[(2)]
Suppose that $A > 0$.
Fix $x_0 \in [a,b]$, let
\[
  M_0 = \sup{|f(x)|}, \:\:\:\:\:\:\:\: M_1 = \sup{|f'(x)|}
\]
for $a \leq x \leq x_0$.
Since $|f'(x)| \leq A|f(x)|$ on $[a,b]$,
\[
  |f'(x)| \leq A|f(x)| \leq A M_0.
\]
Since $A M_0$ is an upper bound for $|f'(x)|$,
\[
  M_1 \leq A M_0.
\]

\item[(3)]
Given any $x \in [a,x_0]$.
Since $f$ is differentiable on $[a,x_0] \subseteq [a,b]$,
by the mean value theorem (Theorem 5.10), there is $\xi \in (a,x)$
such that
\[
  f(x) - f(a) = f'(\xi)(x - a).
\]
Note that $f(a) = 0$ by assumption.
So that
\begin{align*}
  |f(x)|
  &= |f'(\xi)|(x - a) \\
  &\leq M_1 (x - a)
    &(\text{Definition of $M_1$}) \\
  &\leq A M_0 (x - a)
    &((2)) \\
  &\leq A M_0 (x_0 - a).
    &(x \in [a,x_0])
\end{align*}
Since $A M_0 (x_0 - a)$ is an upper bound for $|f(x)|$,
\[
  M_0 \leq A M_0 (x_0 - a).
\]
Take
\[
  x_0 = \min \left\{ \frac{1}{2A} + a, b \right\}
\]
so that $M_0 \leq A M_0 (x_0 - a) \leq \frac{M_0}{2}$.
$M_0 = 0$ or $f(x) = 0$ on $[a,x_0]$.

\item[(4)]
Take a partition
\[
  P = \{ a = x_{-1}, x_0, \ldots, x_n = b \}
\]
of $[a,b]$ such that each subinterval $[x_{i-1},x_i]$ satisfying
$\Delta x_i = x_i - x_{i-1} < \frac{1}{2A}$.
By (3), $f(x) = 0$ on $[x_{-1},x_0]$.
Apply the same argument in (3), $f(x) = 0$ on $[x_0,x_1]$.
Continue this process, $f(x) = 0$ on each subinterval and thus on the whole interval $[a,b]$.
\end{enumerate}
$\Box$ \\



\emph{Note.}
It holds for vector-valued functions too:
\begin{quote}
\emph{Suppose $\mathbf{f}$ is a vector-valued differentiable function on $[a,b]$, $f(a) = 0$,
and there is a real number $A$ such that $|\mathbf{f}'(x)| \leq A|\mathbf{f}(x)|$ on $[a,b]$.
Prove that $\mathbf{f}(x)=0$ for all $x \in [a,b]$.}
\end{quote}
The proof is similar except using Theorem 5.19
($|\mathbf{f}(b) - \mathbf{f}(a)| \leq (b-a)|\mathbf{f}'(x)|$)
in addition. \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.27.}
\emph{Let $\phi$ be a real function defined on a rectangle $R$ in the plane,
given by $a \leq x \leq b$, $\alpha \leq y \leq \beta$.
A \textbf{solution} of the initial-value problem
\[
  y' = \phi(x,y), \:\:\:\:\:\:\:\: y(a) = c \:\:\:\:\:\:\:\: (\alpha \leq c \leq \beta)
\]
is, by definition, a differentiable function $f$ on $[a,b]$ such that
$f(a) = c$, $\alpha \leq f(x) \leq \beta$, and
\[
  f'(x) = \phi(x,f(x)) \:\:\:\:\:\:\:\: (a \leq x \leq b)
\]
Prove that such a problem has at most one solution if there is a constant $A$ such that
\[
  |\phi(x,y_2) - \phi(x,y_1)| \leq A|y_2 - y_1|
\]
whenever $(x,y_1) \in R$ and $(x,y_2) \in R$.
(Hint: Apply Exercise 26 to the difference of two solutions.)
Note that this uniqueness theorem does not hold for the initial-value problem
\[
  y' = y^{\frac{1}{2}}, \:\:\:\:\:\:\:\: y(0) = 0,
\]
which has two solutions: $f(x) = 0$ and $f(x) = \frac{x^2}{4}$.
Find all other solutions.} \\



\emph{Proof (Hint).}
\begin{enumerate}
\item[(1)]
Suppose $f_1$ and $f_2$ are two solutions of that problem.
Define $f = f_1 - f_2$.
$f$ is differentiable on $[a,b]$, $f(a) = f_1(a) - f_2(a) = c - c = 0$.
And
\begin{align*}
  |f'(x)|
  &= |f_1'(x) - f_2'(x)| \\
  &= \abs{ \phi(x,f_1(x)) - \phi(x,f_2(x)) } \\
  &\leq A | f_1(x) - f_2(x) |
\end{align*}
on $[a,b]$.
By Exercise 5.26, $f(x) = 0$ on $[a,b]$, or $f_1(x) = f_2(x)$ on $[a,b]$.

\item[(2)]
\emph{The initial-value problem
\[
  y' = y^{\frac{1}{2}}, \:\:\:\:\:\:\:\: y(0) = 0,
\]
which has two solutions: $f(x) = 0$ and $f(x) = \frac{x^2}{4}$.
Find all other solutions.} \\

  \emph{Note.}
  It does not exist a real $A$ such that $|\phi(x,y_2) - \phi(x,y_1)| \leq A|y_2 - y_1|$
  in this initial-value problem.

  \begin{enumerate}
  \item[(a)]
  Clearly, $f(x) = 0$ and $f(x) = \frac{x^2}{4}$ are two solutions for the initial-value problem.

  \item[(b)]
  Suppose $f(x) \neq 0$ on $[0,\infty)$.
  Since $f'(x) = f(x)^{\frac{1}{2}}$, $f(x) \geq 0$.
  Since $f(x)$ is continuous (Theorem 5.2), the set
  \[
    E = \{ x \in [0, \infty) : f(x) > 0 \}
  \]
  is open in $\mathbb{R}^1$ (Theorem 4.8).
  By Exercise 2.29
  we write $E$ as the union of an at most countable collection of disjoint segments,
  say
  \[
    E = \bigcup_{(a_i,b_i) \subseteq [0, \infty)} (a_i,b_i)
  \]
  where all $(a_i,b_i)$ segments are disjoint.
  Note that $E$ is nonempty.

  \item[(c)]
  For any segment $(a_i,b_i)$,
  define $g(x) = f(x)^{\frac{1}{2}}$ on $(a_i,b_i)$.
  (Clearly, $g(a_i) = f(a_i) = 0$ by the definition of $E$.)
  Thus
  \[
    g'(x) = \frac{1}{2} f(x)^{-\frac{1}{2}} f'(x) = \frac{1}{2}.
  \]
  Hence
  \[
    g(x) = \frac{1}{2} x + c
  \]
  for some constant $c \in \mathbb{R}^1$.
  So
  \[
    f(x) = g(x)^2 = \left( \frac{1}{2} x + c \right)^2.
  \]
  $f(a_i) = 0$ implies that $c = -\frac{a_i}{2}$.
  Hence
  \[
    f(x) = \frac{1}{4}(x - a_i)^2
  \]
  on $(a_i,b_i)$.

  \item[(d)]
  By (c), if $b_i < 0$ is defined as a real number,
  then $f(b_i) = 0$ by definition of $E$.
  Note that
  \[
    \lim_{x \to b_i-} f(x) = \frac{1}{4}(b_i - a_i)^2 > 0,
  \]
  which is absurd.
  Hence $b_i = \infty$ and thus $E$ is of the form
  \[
    E = (a,\infty) \:\:\:\:\:\:\:\: (a \geq 0).
  \]
  Therefore,
  \begin{equation*}
  f(x) =
    \begin{cases}
      0                    & (0 \leq x \leq a), \\
      \frac{1}{4}(x - a)^2 & (x > a \geq 0).
    \end{cases}
  \end{equation*}
  \end{enumerate}
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.28.}
\emph{Formulate and prove an analogous uniqueness theorem for
systems of differential equations of the form
\[
  y'_j = \phi_j(x, y_1, \ldots, y_k), \:\:\:\:\:\:\:\:
  y_j(a) = c_j \:\:\:\:\:\:\:\:
  (j = 1, \ldots, k)
\]
Note that this can be rewritten in the form
\[
  \mathbf{y}' = \bm{\phi}(x,\mathbf{y}), \:\:\:\:\:\:\:\:
  \mathbf{y}(a) = \mathbf{c}
\]
where $\mathbf{y} = (y_1, \ldots, y_k)$ ranges over a $k$-cell,
$\bm{\phi}$ is the mapping of a $(k+1)$-cell into the Euclidean $k$-space
whose components are the function $\phi_1, \ldots, \phi_k$,
and $\mathbf{c}$ is the vector $(c_1, \ldots, c_k)$.
Use Exercise 5.26, for vector-valued functions.} \\

\emph{Proof.}
\begin{enumerate}
\item[(1)]
\emph{A \textbf{solution} of the initial-value problem
\[
  \mathbf{y}' = \bm{\phi}(x,\mathbf{y}), \:\:\:\:\:\:\:\:
  \mathbf{y}(a) = \mathbf{c}
\]
is, by definition, a differentiable function $\mathbf{f}$ on $[a,b]$
such that $\mathbf{f}(a) = \mathbf{c}$, and
\[
  \mathbf{f}'(x) = \bm{\phi}(x,\mathbf{f}(x)) \:\:\:\:\:\:\:\: (a \leq x \leq b).
\]
Then this problem has at most one solution if there is a constant $A$ such that
\[
  \abs{ \bm{\phi}(x,\mathbf{y}_2) - \bm{\phi}(x,\mathbf{y}_1) }
  \leq A \abs{ \mathbf{y}_2 - \mathbf{y}_1 }
\]
whenever $(x,\mathbf{y}_1) \in R$ and $(x,\mathbf{y}_2) \in R$
where $R$ is a $(k+1)$-cell defined by
\[
  R = [a,b] \times [\alpha_1,\beta_1] \times \cdots \times [\alpha_k,\beta_k].
\]}
\item[(2)]
Similar to Exercise 5.27,
Suppose $\mathbf{f}_1$ and $\mathbf{f}_2$ are two solutions of that problem.
Define $\mathbf{f} = \mathbf{f}_1 - \mathbf{f}_2$.
$\mathbf{f}$ is differentiable on $[a,b]$,
$\mathbf{f}(a) = \mathbf{f}_1(a) - \mathbf{f}_2(a) = \mathbf{c} - \mathbf{c} = 0$.
And
\begin{align*}
  |\mathbf{f}'(x)|
  &= |\mathbf{f}_1'(x) - \mathbf{f}_2'(x)| \\
  &= \abs{ \bm{\phi}(x,\mathbf{f}_1(x)) - \bm{\phi}(x,\mathbf{f}_2(x)) } \\
  &\leq A | \mathbf{f}_1(x) - \mathbf{f}_2(x) |
\end{align*}
on $[a,b]$.
By Note in Exercise 5.26,
$\mathbf{f}(x) = 0$ on $[a,b]$, or $\mathbf{f}_1(x) = \mathbf{f}_2(x)$ on $[a,b]$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\textbf{Exercise 5.29.}
\emph{Specialize Exercise 5.28 by considering the system
\begin{align*}
  y_j' &= y_{j+1} \:\:\:\:\:\:\:\: (j = 1, \ldots, k-1), \\
  y_k' &= f(x) - \sum_{j=1}^{k}{g_j(x)y_j}
\end{align*}
where $f, g_1, \ldots, g_k$ are continuous real functions on $[a,b]$,
and derive a uniqueness theorem for solutions of the equation
\[
  y^{(k)} + g_k(x)y^{(k-1)} + \cdots + g_2(x)y' + g_1(x)y = f(x),
\]
  subject to initial conditions
\[
  y(a) = c_1, \:\:\:\:\:\:\:\:
  y'(a) = c_1, \:\:\:\:\:\:\:\:
  \ldots, \:\:\:\:\:\:\:\:
  y^{(k-1)}(a) = c_k.
\]}

\emph{Proof.}
\begin{enumerate}
\item[(1)]
Write
\begin{align*}
  \mathbf{y}
  &= (y_1, \ldots, y_k) \\
  &= \left(y, y', y'', \ldots, y^{(k-1)}\right), \\
  \bm{\phi}(x, \mathbf{y})
  &= \left(y_2, y_3, \ldots, y_{k-1}, f(x) - \sum_{j=1}^{k}{g_j(x)y_j}\right) \\
  &= \left(y', y'', \ldots, y^{(k-1)}, f(x) - \sum_{j=1}^{k}{g_j(x)y^{(j-1)}}\right), \\
  \mathbf{c}
  &= (c_1, \ldots, c_k).
\end{align*}
So that
\[
  \mathbf{y}' = \bm{\phi}(x,\mathbf{y}), \:\:\:\:\:\:\:\:
  \mathbf{y}(a) = \mathbf{c}
\]
where $\mathbf{y}$ ranges over a $k$-cell $R$.

\item[(2)]
\emph{To show that the problem has at most one solution, by Exercise 5.28
it suffices to show that there is a constant $A$ such that
\[
  \abs{ \bm{\phi}(x,\mathbf{y}) - \bm{\phi}(x,\mathbf{z}) }
  \leq A \abs{ \mathbf{y} - \mathbf{z} }
\]
whenever $(x,\mathbf{y}) \in R$ and $(x,\mathbf{z}) \in R$.}

\item[(3)]
Since all $g_j$ ($1 \leq j \leq k$) are real continuous functions on a compact set $[a,b]$,
all $g_j$ are bounded (Theorem 4.15),
say $|g_j| \leq M$ on $[a,b]$ for some $M_j \in \mathbb{R}^1$ ($1 \leq j \leq k$).

\item[(4)]
Write $\mathbf{y} = (y_{1}, \ldots, y_{k})$
and $\mathbf{z} = (z_{1}, \ldots, z_{k})$.
So
\begin{align*}
  &\abs{ \bm{\phi}(x,\mathbf{y}) - \bm{\phi}(x,\mathbf{z}) }^2 \\
  =&
  \abs{ \left(y_{2} - z_{2}, y_{3} - z_{3}, \ldots, y_{k-1} - z_{k-1},
    - \sum_{j=1}^{k}{g_j(x)(y_{j} - z_{j})}\right) }^2 \\
  =&
  \sum_{j=2}^{k-1} (y_{j} - z_{j})^2
    + \left( -\sum_{j=1}^{k}{g_j(x)(y_{j} - z_{j})} \right)^2 \\
  \leq&
  \sum_{j=2}^{k-1} (y_{j} - z_{j})^2
    + \sum_{j=1}^{k} g_j(x)^2 \sum_{j=1}^{k}(y_{j} - z_{j})^2
    &(\text{Theorem 1.35}) \\
  \leq&
  \sum_{j=2}^{k-1} (y_{j} - z_{j})^2
    + \sum_{j=1}^{k} M_j^2 \sum_{j=1}^{k}(y_{j} - z_{j})^2
    &((3)) \\
  \leq&
  \sum_{j=1}^{k} (y_{j} - z_{j})^2
    + \sum_{j=1}^{k} M_j^2 \sum_{j=1}^{k}(y_{j} - z_{j})^2
    &(x^2 \geq 0 \: \forall x \in \mathbb{R}^1) \\
  \leq&
   \left( 1 + \sum_{j=1}^{k} M_j^2 \right) |\mathbf{y} - \mathbf{z}|^2.
\end{align*}
Hence
$\abs{ \bm{\phi}(x,\mathbf{y}) - \bm{\phi}(x,\mathbf{z}) }
\leq A \abs{ \mathbf{y} - \mathbf{z} }$
for some $A = \left( 1 + \sum_{j=1}^{k} M_j^2 \right)^{\frac{1}{2}}$.
\end{enumerate}
$\Box$ \\\\



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\end{document}